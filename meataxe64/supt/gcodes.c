/*   gcodes.c Grease Codes Module   */
/*   R. A. Parker 24.9.2016       */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>
#include "field.h"
#include "hpmi.h"
#include "pcrit.h"
#include "slab.h"
#include "linf.h"
#include "gcodes.h"

// AS codes
// Best I know, except Addition Chain may be shortened
//         Deficit currently 19 (17-251)
// 113 [5]->[4] 131 [5]->[4]
// 163 [5]->[4] 173 [4]->[3] 179 [4]->[3] 181 [5]->[4]
// 191 [4]->[3] 193 [5]->[4] 197 [6]->[4] 199 [4]->[3]
// 211 [3]->[2] 223 [6]->[3] 227 [4]->[3] 229 [3]->[2]
// 239 [3]->[2] 251 [3]->[2]

uint16_t ascode[] = {

        17, 5, 0,1,2,5,8,
        19, 5, 0,1,2,6,9,
        23, 6, 0,1,2,3,7,11,
        29, 7, 0,1,2,4,8,9,18,
        31, 6, 0,1,4,10,12,17,
        37, 7, 0,1,4,5,12,14,20,
        41, 8, 0,1,2,3,4,10,15,20,
        43, 8, 0,1,2,4,8,13,18,23,
        47, 8, 0,1,4,9,14,19,21,25,
        53, 9, 0,1,2,4,8,13,18,23,28,
        59, 9, 0,1,2,6,14,15,22,25,32,
        61, 9, 0,1,3,5,9,21,37,44,51,
        67,10, 0,1,2,3,6,12,18,32,46,60,
        71,10, 0,1,2,3,8,12,24,25,39,53,
        73, 9, 0,1,3,7,15,31,36,54,63,
        79,10, 0,1,5,8,16,27,29,35,47,70,
        83,11, 0,1,2,4,8,18,36,72,144,146,290,
        89,11, 0,1,4,5,12,14,32,48,49,64,70,
        97,12, 0,1,2,3,6,12,18,20,26,46,68,136,
       101,12, 0,1,2,3,4,12,17,24,30,43,56,68,
       103,12, 0,1,2,3,4,12,19,24,38,44,57,76,
       107,12, 0,1,2,6,7,10,22,24,35,51,70,77,
       109,12, 0,1,4,15,17,21,42,47,49,91,182,101,
       113,12, 0,1,4,9,16,23,29,40,50,66,82,84,
       127,13, 0,1,4,10,14,17,22,33,64,66,86,101,103,
       131,13, 0,1,8,12,21,29,58,31,83,96,117,7,99,
       137,14, 0,1,2,3,4,12,20,25,40,46,60,67,88,108,
       139,14, 0,1,2,4,11,13,22,28,33,41,47,66,82,89,
       149,14, 0,1,5,13,23,33,36,42,48,59,72,86,88,93,
       151,15, 0,1,2,3,6,9,12,18,24,44,64,84,104,124,138,
       157,15, 0,1,2,3,4,12,20,28,48,56,84,33,62,91,120,
       163,15, 0,1,2,3,4,13,21,38,45,61,67,76,114,137,81,
       167,15, 0,1,5,9,17,31,36,96,98,115,118,121,128,130,139,
       173,16, 0,1,2,3,4,5,6,7,18,28,46,94,38,66,124,75,
       179,16, 0,1,2,3,4,5,6,17,34,43,53,61,96,114,107,159,
       181,16, 0,1,3,5,7,9,11,13,35,55,88,110,124,141,163,125,
       191,17, 0,1,2,3,4,5,6,7,8,20,31,51,42,73,104,137,83,
       193,17, 0,1,3,5,7,9,11,13,15,17,62,84,105,150,168,85,169,
       197,17, 0,1,3,5,7,9,11,13,15,39,55,56,98,140,177,120,74,
       199,17, 0,1,2,3,4,5,6,7,19,38,48,59,68,107,127,119,177,
       211,18, 0,1,2,3,4,5,6,7,8,20,30,42,63,105,126,52,136,72,
       223,18, 0,1,2,3,4,5,6,7,20,50,90,131,39,151,59,161,28,119,
       227,19, 0,1,2,3,4,5,6,7,8,9,10,24,37,50,61,87,124,163,99,
       229,19, 0,1,2,6,10,14,18,22,26,30,34,38,49,84,133,135,90,91,93,
       233,19, 0,1,2,3,8,18,28,38,48,58,68,78,88,98,99,102,107,120,111,
       239,19, 0,1,2,3,4,5,6,7,8,20,32,64,96,128,87,107,194,206,74,
       241,19, 0,1,2,3,4,5,17,34,51,68,85,102,119,136,153,41,76,188,23,
       251,20, 0,1,2,3,4,5,6,7,8,9,10,24,36,50,75,125,150,62,162,86,
        0 };

uint16_t aascode[] = {
        13, 4, 0,1,2,4,
        17, 4, 0,1,4,6,
        19, 4, 0,1,4,6,
        23, 5, 0,1,3,5,10,
        29, 5, 0,1,2,4,12,
        31, 5, 0,1,4,8,10,
        37, 5, 0,1,5,7,17,
        41, 5, 0,1,4,12,18,
        43, 6, 0,1,2,8,12,24,
        47, 6, 0,1,4,6,10,20,
        53, 6, 0,1,2,4,16,32,
        59, 6, 0,1,4,6,16,26,
        61, 6, 0,1,2,6,18,27,
        67, 6, 0,1,4,14,22,38,
        71, 7, 0,1,4,8,18,20,29,
        73, 7, 0,1,2,6,9,24,36,
        79, 7, 0,1,2,6,18,27,36,
        83, 7, 0,1,4,6,12,24,37,
        89, 7, 0,1,2,6,9,25,39,
        97, 7, 0,1,2,12,15,34,40,
       101, 7, 0,1,4,17,38,40,49,
       103, 7, 0,1,6,20,22,44,53,
       107, 7, 0,1,6,20,22,46,55,
       109, 8, 0,1,2,6,9,24,33,66,
       113, 8, 0,1,2,6,18,20,40,49,
       127, 8, 0,1,4,8,10,32,43,59,
       131, 8, 0,1,4,12,14,20,40,61,
       137, 8, 0,1,3,12,27,58,64,93,
       139, 8, 0,1,4,7,16,26,49,63,
       149, 8, 0,1,6,18,26,53,109,112,
       151, 8, 0,1,6,14,52,56,72,134,
       157, 9, 0,1,2,6,18,36,45,90,93,
       163, 9, 0,1,3,7,12,15,40,60,75,
       167, 9, 0,1,4,16,32,40,42,92,138,
       173, 9, 0,1,6,18,26,28,64,120,124,
       179, 9, 0,1,4,10,15,37,59,81,83,
       181, 9, 0,1,3,5,13,14,29,82,135,
       191, 9, 0,1,4,10,27,42,43,113,134,
       193, 9, 0,1,4,6,26,37,60,76,106,
       197, 9, 0,1,7,12,16,48,50,73,119,
       199, 9, 0,1,12,14,18,72,108,152,172,
       211,10, 0,1,4,8,10,16,21,52,78,104,
       223,10, 0,1,4,8,10,13,30,61,92,107,
       227,10, 0,1,4,10,13,15,38,53,83,113,
       229,10, 0,1,2,3,8,12,42,63,80,105,
       233,10, 0,1,2,6,20,27,60,93,96,109,
       239,10, 0,1,8,17,27,31,60,118,176,201,
       241,10, 0,1,8,12,28,52,58,164,166,176,
       251,10, 0,1,8,12,28,32,68,70,115,186,
       257,10, 0,1,2,12,20,58,75,155,159,226,
       263,10, 0,1,6,14,33,35,108,115,145,206,
       269,10, 0,1,14,19,25,41,71,86,124,174,
       271,10, 0,1,7,16,40,61,93,119,123,191,
       277,11, 0,1,6,14,24,68,70,90,102,105,153,
       281,11, 0,1,8,28,56,60,74,84,89,120,178,
       283,11, 0,1,4,12,14,30,50,90,124,166,228,
       293,11, 0,1,4,6,14,40,56,57,77,138,166,
       307,11, 0,1,2,12,18,21,44,74,112,120,151,
       311,11, 0,1,13,26,28,36,76,105,137,146,218,
       313,11, 0,1,22,25,48,59,66,97,170,174,179,
       317,11, 0,1,11,28,66,80,89,122,124,129,170,
       331,11, 0,1,3,32,40,98,103,158,170,180,285,
       337,12, 0,1,2,15,18,39,47,94,135,171,265,271,
       347,12, 0,1,6,14,24,25,50,59,110,127,139,192,
       349,12, 0,1,3,8,12,18,60,66,96,194,214,240,
       353,12, 0,1,3,5,22,31,88,99,133,139,183,208,
       359,12, 0,1,20,22,32,47,50,58,155,160,215,259,
       367,12, 0,1,3,8,18,32,65,71,134,192,227,285,
       373,12, 0,1,4,9,24,45,57,87,100,222,224,312,
       379,12, 0,1,33,42,44,63,119,129,143,189,259,287,
       383,12, 0,1,4,7,30,42,44,102,153,208,270,294,
       389,12, 0,1,7,9,25,47,70,82,132,138,247,250,
       397,12, 0,1,6,30,76,91,158,274,276,301,314,380,
       401,13, 0,1,4,20,44,53,67,88,150,160,182,187,188,
       409,13, 0,1,4,10,12,40,53,68,142,167,303,334,340,
       419,13, 0,1,2,8,12,29,45,64,121,209,242,289,321,
       421,13, 0,1,3,20,42,55,60,120,130,151,196,254,392,
       431,13, 0,1,5,11,26,34,47,56,115,117,165,181,248,
       433,13, 0,1,10,42,54,67,121,167,172,185,206,419,427,
       439,13, 0,1,9,13,33,73,75,88,94,153,310,336,339,
       443,13, 0,1,3,5,14,45,68,148,277,324,339,365,372,
       449,13, 0,1,3,15,23,48,59,102,163,193,198,313,364,
       457,13, 0,1,2,18,22,48,55,114,122,128,199,296,334,
       461,13, 0,1,6,21,54,62,145,199,346,356,359,375,435,
       463,13, 0,1,4,17,20,43,117,118,124,188,196,243,449,
       467,13, 0,1,4,9,34,61,67,182,193,324,368,378,388,
       479,14, 0,1,4,7,16,50,55,89,91,118,219,237,245,345,
       487,14, 0,1,4,10,18,20,30,90,95,113,147,178,303,348,
       491,14, 0,1,2,10,40,51,86,111,128,217,235,299,434,439,
       499,14, 0,1,3,12,34,37,83,132,149,153,192,207,222,245,
       503,14, 0,1,3,5,16,36,76,113,121,137,242,319,325,344,
       509,14, 0,1,4,12,42,49,222,235,237,258,304,351,364,426,
       521,14, 0,1,5,10,18,34,41,110,121,164,218,279,306,361,
       523,14, 0,1,2,8,21,99,194,212,284,301,349,448,471,480,
       541,14, 0,1,8,39,42,95,112,123,125,168,222,228,393,491,
       547,14, 0,1,2,31,36,80,118,166,186,190,208,211,309,445,
       557,14, 0,1,5,18,49,65,95,105,171,226,287,359,378,412,
       563,15, 0,1,6,11,27,36,61,156,173,207,220,222,300,473,481,
       569,15, 0,1,9,23,25,70,90,121,146,191,196,206,245,284,436,
       571,15, 0,1,8,12,17,57,59,67,155,235,271,305,390,465,482,
       577,15, 0,1,5,9,41,52,140,141,189,284,290,360,396,414,556,
       587,15, 0,1,18,50,85,87,114,128,170,226,284,285,306,318,444,
       593,15, 0,1,20,42,58,122,151,158,178,313,468,476,486,507,510,
       599,15, 0,1,4,6,16,106,208,217,253,283,305,342,464,472,576,
       601,15, 0,1,2,7,20,59,85,100,114,147,170,239,256,306,359,
       607,15, 0,1,13,15,19,40,56,105,138,184,243,254,330,429,594,
       613,15, 0,1,4,14,26,42,128,137,154,217,295,373,421,556,567,
       617,15, 0,1,3,9,40,47,131,147,164,216,220,367,426,537,563,
       619,15, 0,1,9,44,82,96,175,245,260,284,313,325,346,372,421,
       631,15, 0,1,22,33,48,60,62,64,164,170,293,368,410,440,465,
       641,16, 0,1,4,21,38,48,82,162,181,187,270,279,324,446,451,516,
       643,16, 0,1,7,15,31,34,42,62,85,117,202,251,351,355,413,535,
       647,16, 0,1,5,13,15,66,99,103,124,149,160,215,227,245,398,413,
       653,16, 0,1,7,14,17,24,51,56,60,170,182,238,251,300,385,399,
       659,16, 0,1,2,5,22,33,48,67,85,171,183,193,284,327,341,394,
       661,16, 0,1,6,12,32,38,60,79,199,268,288,515,519,536,549,565,
       673,16, 0,1,3,18,44,55,74,121,209,215,273,349,424,471,498,506,
       677,16, 0,1,7,10,28,32,38,68,86,238,282,384,530,565,577,579,
       683,16, 0,1,6,16,39,67,90,92,109,131,242,373,385,403,530,585,
       691,16, 0,1,5,17,34,90,121,141,147,150,222,233,351,387,389,417,
       701,16, 0,1,22,30,44,56,91,92,133,142,144,216,270,324,371,479,
       709,16, 0,1,36,49,70,87,91,187,198,368,493,499,503,508,536,686,
       719,16, 0,1,6,44,53,88,115,168,273,398,443,547,572,686,689,699,
       727,16, 0,1,6,49,55,66,80,88,101,218,274,350,413,571,605,617,
       733,16, 0,1,14,26,34,37,43,76,114,204,231,312,420,425,602,660,
       739,16, 0,1,26,40,43,49,87,105,121,266,293,353,424,443,592,599,
       743,16, 0,1,14,26,48,98,174,207,211,213,218,267,282,335,416,518,
       751,16, 0,1,25,37,46,102,118,330,331,429,578,607,611,638,646,697,
       757,17, 0,1,7,19,36,58,124,149,180,223,286,291,306,321,544,681,712,
       761,17, 0,1,3,8,34,42,54,113,133,205,280,298,320,415,424,440,528,
       769,17, 0,1,8,29,53,111,115,117,124,155,232,236,287,305,449,509,569,
       773,17, 0,1,4,8,32,34,43,66,101,131,211,327,344,357,397,599,615,
       787,17, 0,1,8,28,34,36,52,143,188,191,228,273,328,350,366,426,569,
       797,17, 0,1,37,44,68,73,79,124,187,263,339,347,356,359,366,445,481,
       809,17, 0,1,2,15,42,54,112,157,201,204,234,266,270,329,562,572,680,
       811,17, 0,1,26,37,73,123,129,269,328,330,343,349,538,589,656,721,755,
       821,17, 0,1,15,32,71,73,78,99,144,147,160,444,464,492,644,655,667,
       823,17, 0,1,26,40,48,61,70,155,214,345,350,378,492,548,644,744,747,
       827,17, 0,1,16,33,39,41,86,91,160,202,220,286,392,463,495,629,730,
       829,17, 0,1,4,65,66,77,132,204,229,279,297,299,401,452,543,643,735,
       839,17, 0,1,33,66,88,100,134,165,174,178,188,270,272,391,476,506,589,
       853,17, 0,1,6,45,58,73,118,181,206,307,347,477,538,548,568,804,816,
       857,18, 0,1,3,16,34,35,43,49,55,84,174,186,196,258,297,388,404,483,
       859,18, 0,1,2,5,20,28,71,92,114,245,251,258,319,448,477,535,624,695,
       863,18, 0,1,10,24,60,90,94,137,161,186,200,303,329,334,632,717,719,732,
       877,18, 0,1,7,34,71,76,79,114,128,214,282,284,304,313,520,540,611,680,
       881,18, 0,1,24,32,39,72,158,178,220,248,378,588,592,635,641,693,836,846,
       883,18, 0,1,7,26,30,43,195,257,390,405,410,444,662,673,749,787,817,843,
       887,18, 0,1,7,10,24,29,69,105,248,252,266,291,302,312,457,551,761,786,
       907,18, 0,1,2,9,13,68,118,138,148,295,307,340,358,426,463,604,657,691,
       911,18, 0,1,5,10,18,30,87,98,106,143,228,255,258,347,349,375,605,646,
       919,18, 0,1,58,62,104,119,133,154,198,272,278,284,342,379,456,714,724,915,
       929,18, 0,1,19,32,43,126,132,160,193,255,262,266,442,480,753,777,839,851,
       937,18, 0,1,13,27,52,54,150,167,300,402,426,516,571,579,594,750,832,880,
       941,18, 0,1,3,14,20,46,53,153,181,229,413,443,524,611,614,656,845,917,
       947,18, 0,1,5,13,59,122,248,274,380,386,413,692,725,762,764,860,895,931,
       953,18, 0,1,13,26,37,44,99,128,222,282,288,419,557,562,596,787,791,845,
       967,18, 0,1,16,18,43,51,60,89,107,113,186,255,295,413,521,655,676,778,
       971,19, 0,1,15,21,56,59,118,160,161,170,236,242,290,359,364,532,603,618,695,
       977,19, 0,1,11,60,64,96,133,252,290,296,297,516,570,584,607,609,669,927,970,
       983,19, 0,1,42,46,53,55,66,93,190,233,455,566,598,601,606,685,756,766,843,
       991,19, 0,1,10,12,28,79,102,134,174,188,262,277,315,364,384,392,498,670,712,
       997,19, 0,1,10,14,27,44,84,89,109,216,242,309,430,442,489,542,586,634,705,
      1009,19, 0,1,11,20,71,97,110,115,154,156,189,333,339,354,445,652,715,775,929,
      1013,19, 0,1,8,19,55,57,88,120,178,286,381,382,394,396,480,508,763,869,896,
      1019,19, 0,1,26,45,55,61,91,144,171,209,216,230,437,440,470,533,551,654,682,
      1021,19, 0,1,19,33,38,46,54,77,141,146,356,358,368,462,504,533,624,794,866,
      1031,19, 0,1,3,6,10,40,55,103,128,148,149,198,264,342,383,447,529,643,814,
      1033,19, 0,1,13,24,49,78,110,113,141,180,287,366,372,416,430,432,612,632,639,
      1039,19, 0,1,12,18,60,88,104,110,112,139,157,401,404,435,509,628,667,876,978,
      1049,19, 0,1,5,24,32,73,129,237,303,374,395,496,510,655,665,746,902,954,992,
      1051,19, 0,1,17,49,82,103,118,158,178,194,292,305,370,474,476,548,558,713,803,
      1061,19, 0,1,24,31,51,65,79,132,261,270,319,618,639,675,895,920,964,1022,1040,
      1063,19, 0,1,12,25,27,71,175,329,426,522,652,654,682,742,790,853,858,867,924,
      1069,19, 0,1,7,31,59,73,76,78,171,282,398,402,406,442,521,613,884,970,1045,
      1087,20, 0,1,6,13,31,33,54,71,107,182,186,216,229,285,302,304,308,528,655,664,
      1091,20, 0,1,2,6,15,23,97,123,154,162,292,322,415,478,603,667,727,873,977,1014,
      1093,19, 0,1,240,241,246,318,323,339,341,455,496,552,608,617,642,889,903,951,1008,
      1097,20, 0,1,25,41,63,86,91,97,141,173,227,233,235,516,526,671,721,833,846,850,
      1103,20, 0,1,22,32,39,71,98,99,113,178,270,277,359,533,716,720,729,851,853,962,
      1109,20, 0,1,5,15,17,28,38,57,170,266,268,428,456,551,604,625,663,689,747,810,
      1117,20, 0,1,8,20,34,38,95,132,161,205,211,243,263,306,412,429,600,645,655,771,
      1123,20, 0,1,3,16,24,34,103,126,148,207,253,337,491,596,614,725,773,903,1085,1097,
      1129,20, 0,1,3,9,13,38,74,88,136,321,340,437,514,601,656,835,894,990,1045,1085,
      1151,20, 0,1,7,18,43,64,68,99,176,196,271,443,452,475,483,491,788,832,1004,1037,
      1153,20, 0,1,13,32,71,113,146,231,275,302,379,396,453,611,619,634,640,749,808,812,
      1163,20, 0,1,2,13,19,22,38,68,93,95,230,264,269,333,408,467,539,658,692,819,
      1171,20, 0,1,14,20,21,60,150,211,216,470,520,521,604,816,824,909,940,963,1009,1095,
      1181,20, 0,1,13,34,37,50,124,126,134,188,205,533,576,771,777,780,815,959,1086,1158,
      1187,20, 0,1,4,21,45,46,61,68,139,158,245,337,365,438,620,715,747,902,920,1087,
      1193,20, 0,1,27,46,52,120,146,229,231,251,274,374,439,489,506,555,562,590,614,1157,
      1201,20, 0,1,6,9,32,69,154,176,204,228,255,367,436,478,507,564,604,806,887,889,
      1213,20, 0,1,13,15,28,82,142,158,179,315,376,379,385,423,529,540,858,936,961,965,
      1217,20, 0,1,35,49,91,135,199,211,325,331,352,378,455,835,885,899,1004,1006,1148,1151,
      1223,20, 0,1,6,32,110,343,352,360,396,506,548,660,676,789,821,853,964,1032,1034,1166,
      1229,21, 0,1,6,20,51,76,78,120,137,450,494,515,590,632,813,921,925,1047,1121,1131,1194,
      1231,21, 0,1,2,3,7,20,34,91,101,185,276,292,403,441,464,549,560,582,1037,1188,1197,
      1237,21, 0,1,19,46,52,63,87,133,172,224,362,384,426,500,583,604,623,641,670,836,1224,
      1249,21, 0,1,39,42,208,315,317,375,377,397,501,574,613,641,661,688,763,764,769,1016,1079,
      1259,21, 0,1,12,48,51,55,96,111,148,153,204,356,443,446,468,788,807,931,1042,1044,1088,
      1277,21, 0,1,45,102,123,152,198,240,280,357,360,411,523,543,545,556,673,713,970,1073,1139,
      1279,21, 0,1,31,38,40,106,117,197,265,296,343,374,486,534,537,843,853,972,1057,1172,1254,
      1283,21, 0,1,12,28,48,66,109,124,134,184,197,291,370,546,549,578,591,1005,1013,1046,1054,
      1289,21, 0,1,11,25,78,140,144,185,204,294,302,511,583,719,874,929,977,979,1003,1028,1232,
      1291,21, 0,1,10,43,67,143,198,316,366,439,451,459,498,741,756,778,781,784,955,1026,1247,
      1297,21, 0,1,2,4,97,131,195,232,295,307,339,561,884,901,926,968,983,988,1009,1145,1146,
      1301,21, 0,1,16,66,93,136,231,275,345,353,356,498,564,567,650,739,806,879,885,894,1074,
      1303,21, 0,1,4,9,71,134,137,206,232,323,352,371,373,620,871,894,927,939,1180,1197,1210,
      1307,21, 0,1,2,5,54,64,112,186,333,373,419,456,533,676,785,927,1034,1085,1105,1137,1178,
      1319,21, 0,1,22,71,78,220,231,235,242,512,513,538,552,557,644,704,759,762,924,957,1208,
      1321,21, 0,1,5,174,202,215,243,262,263,450,595,600,784,897,904,953,967,976,1031,1109,1222,
      1327,21, 0,1,48,54,86,142,159,241,246,259,272,318,473,498,560,621,636,796,1175,1219,1231,
      1361,22, 0,1,13,17,66,84,109,122,129,148,151,269,407,415,422,560,634,636,792,872,1002,1035,
      1367,21, 0,1,2,22,109,144,169,186,345,377,506,570,581,652,680,683,698,950,1088,1214,1306,
      1373,21, 0,1,4,6,99,181,229,259,302,408,414,458,499,522,532,683,865,987,1127,1320,1345,
      1381,22, 0,1,40,44,60,81,171,224,226,232,256,301,332,404,429,687,748,923,1000,1044,1084,1259,
      1399,22, 0,1,12,14,19,57,85,99,320,420,477,501,609,615,621,667,725,834,1100,1191,1252,1269,
      1409,22, 0,1,4,12,17,44,71,125,144,166,175,244,301,535,556,603,620,717,745,975,1038,1082,
      1423,22, 0,1,8,50,58,70,81,148,333,441,467,635,695,738,794,938,951,955,1114,1339,1376,1392,
      1427,22, 0,1,13,59,91,132,143,152,165,219,363,378,381,532,558,617,659,724,1050,1110,1345,1412,
      1429,22, 0,1,4,109,172,238,363,381,387,493,507,539,571,604,620,711,1077,1135,1191,1231,1233,1379,
      1433,22, 0,1,85,89,101,193,344,354,355,487,619,666,684,707,734,744,824,833,853,974,1172,1370,
      1439,22, 0,1,10,15,36,78,139,172,179,199,375,413,421,479,501,549,696,870,898,1047,1358,1362,
      1447,22, 0,1,9,21,40,57,117,121,186,260,380,398,464,509,550,644,673,731,807,1048,1086,1234,
      1451,22, 0,1,13,63,91,107,114,151,182,183,237,359,397,470,495,536,735,752,774,855,857,1222,
      1453,22, 0,1,6,22,39,50,145,220,287,297,323,372,519,742,815,823,845,868,1031,1245,1293,1367,
      1459,22, 0,1,5,26,48,86,156,198,221,256,332,416,447,508,584,744,761,873,925,969,1138,1147,
      1471,22, 0,1,4,48,77,166,171,179,207,306,308,493,
               518,766,771,973,994,1277,1350,1364,1416,1456,
      1481,22, 0,1,6,14,15,33,44,122,125,273,431,653,688,
               723,831,925,1149,1174,1283,1306,1316,1369,
      1483,22, 0,1,8,12,42,171,236,245,357,382,419,493,508,
               539,706,732,929,1053,1091,1295,1311,1411,
      1487,22, 0,1,46,133,171,173,195,198,207,264,490,554,
               649,691,794,1077,1080,1088,1212,1279,1358,1359,
      1489,22, 0,1,18,65,84,105,200,234,267,323,429,566,568,746,
               767,776,858,1056,1248,1276,1317,1348,
      1493,22, 0,1,39,56,87,166,182,208,222,233,517,578,640,
               800,835,899,973,1069,1115,1325,1343,1461,
      1499,22, 0,1,34,76,82,145,166,197,262,288,342,441,785,951,
               964,1030,1038,1100,1189,1332,1405,1449,
      1511,23, 0,1,14,23,26,102,140,143,198,284,285,289,393,444,
               446,452,496,633,675,839,995,1212,1340,
      1523,23, 0,1,14,43,44,136,160,167,214,240,365,416,460,462,624,
               628,886,905,956,961,1170,1177,1254,
      1531,23, 0,1,12,59,74,86,104,106,169,170,248,339,365,444,
               510,596,611,761,807,882,1012,1056,1503,
      1543,23, 0,1,10,15,32,69,154,216,254,278,282,315,329,
               371,478,599,640,864,873,881,1083,1137,1167,
      1549,23, 0,1,12,30,75,117,144,169,244,274,293,381,454,
               494,495,501,571,753,825,857,1133,1383,1468,
      1553,23, 0,1,24,58,155,156,225,252,289,307,409,415,434,
               746,767,768,930,1231,1255,1297,1361,1407,1536,
      1559,23, 0,1,3,6,22,34,74,101,121,184,299,381,570,609,
               626,812,999,1103,1160,1168,1245,1296,1319,
      1567,23, 0,1,10,28,89,93,124,244,266,493,523,540,546,579,
               595,645,754,1113,1235,1372,1388,1492,1494,
      1571,23, 0,1,21,47,59,65,190,217,241,330,343,450,604,
               667,702,840,1018,1113,1140,1167,1236,1408,1415,
      1579,23, 0,1,35,48,50,64,100,109,275,372,492,597,761,792,
               840,845,878,999,1045,1115,1125,1491,1555,
      1583,23, 0,1,18,61,121,219,304,308,338,387,418,564,608,620,
               815,822,857,1026,1202,1336,1391,1478,1544,
      1597,23, 0,1,8,11,55,115,142,185,190,446,459,480,484,517,549,
               613,755,1080,1162,1337,1356,1377,1517,
      1601,23, 0,1,23,34,75,81,232,240,476,714,753,796,837,874,892,
               1014,1023,1029,1104,1298,1303,1460,1494,
      1607,23, 0,1,28,60,130,174,178,231,309,374,419,517,519,526,838,
               853,902,909,993,1021,1108,1127,1313,
      1609,23, 0,1,18,49,50,62,126,142,176,185,393,396,398,436,
               554,807,1046,1100,1127,1162,1331,1462,1476,
      1613,23, 0,1,38,103,119,134,153,180,191,359,622,804,808,853,
               931,1011,1025,1051,1139,1146,1326,1384,1460,
      1619,23, 0,1,3,58,182,183,196,214,279,314,368,371,402,528,
               575,596,634,870,1137,1176,1204,1475,1600,
      1621,23, 0,1,23,39,192,213,302,323,533,615,626,638,681,
               685,700,709,714,886,903,1095,1266,1319,1406,
      1627,23, 0,1,11,65,78,84,102,241,373,423,462,544,648,649,679,
               682,894,963,998,1160,1290,1501,1535,
      1637,23, 0,1,13,107,174,198,258,260,274,314,397,403,442,461,
               700,765,792,1023,1040,1064,1278,1356,1503,
      1657,23, 0,1,41,75,85,89,97,214,216,223,337,361,554,733,859,
               1170,1175,1277,1303,1329,1335,1473,1534,
      1663,23, 0,1,9,71,132,153,245,257,383,411,592,644,724,747,
               949,1031,1065,1131,1392,1414,1457,1529,1575,
      1667,23, 0,1,43,54,141,146,176,231,302,560,563,604,640,784,
               817,1020,1120,1309,1340,1354,1374,1471,1645,
      1669,23, 0,1,6,63,91,202,209,273,309,322,349,670,800,866,
               874,909,1066,1130,1350,1353,1428,1525,1652,
      1693,24, 0,1,12,22,50,54,75,82,111,141,176,239,314,323,408,
               626,658,825,827,830,1175,1195,1299,1409,
      1697,24, 0,1,4,24,43,68,98,149,159,180,239,337,382,581,
               765,848,1020,1199,1310,1330,1368,1436,1439,1648,
      1699,24, 0,1,22,61,91,107,139,228,300,340,349,545,580,584,
               659,946,955,973,979,1037,1056,1080,1082,1387,
      1709,24, 0,1,4,23,30,172,198,218,238,263,279,498,506,530,
               577,623,657,719,1020,1042,1073,1181,1204,1579,
      1721,24, 0,1,21,26,58,74,78,92,121,232,251,262,383,712,
               958,1075,1114,1124,1168,1203,1368,1442,1495,1618,
      1723,24, 0,1,32,157,215,230,232,240,421,536,674,680,782,
               786,914,946,1003,1038,1408,1532,1550,1601,1620,1643,
      1733,24, 0,1,13,24,71,91,92,206,278,301,412,440,457,492,
               558,647,789,796,827,863,929,1021,1038,1613,
      1741,24, 0,1,8,10,23,95,97,259,564,568,593,609,693,731,853,
               1016,1071,1093,1274,1284,1314,1374,1435,1693,
      1747,24, 0,1,11,35,75,155,156,291,304,329,331,388,546,732,
               925,966,1258,1337,1372,1400,1498,1641,1682,1695,
      1753,24, 0,1,4,17,39,85,100,112,193,248,270,319,328,375,
               499,505,793,821,911,1191,1320,1368,1411,1508,
      1759,24, 0,1,14,23,46,89,179,199,220,235,236,347,506,713,948,
               970,1083,1085,1186,1193,1221,1506,1518,1579,
      1777,24, 0,1,6,15,59,67,79,86,200,318,451,478,526,548,639,717,
               792,1169,1434,1478,1543,1566,1588,1626,
      1783,24, 0,1,17,49,57,94,208,225,236,334,359,394,435,730,
               734,804,814,912,976,1039,1129,1398,1502,1536,
      1787,24, 0,1,17,97,130,200,208,262,269,282,325,369,525,611,
               788,793,938,941,967,1157,1376,1490,1495,1682,
      1789,24, 0,1,50,84,87,139,148,192,240,399,494,549,622,
               708,711,728,807,831,933,1074,1076,1467,1534,1757,
      1801,24, 0,1,8,22,51,92,130,182,256,260,444,490,517,599,
               689,821,938,975,1241,1267,1276,1364,1574,1716,
      1811,24, 0,1,10,33,43,52,63,69,87,190,395,607,644,
               740,805,861,865,883,890,1143,1350,1424,1575,1644,
      1823,24, 0,1,11,20,40,76,136,209,524,578,881,915,994,
               1107,1121,1198,1210,1258,1295,1298,1302,1423,1469,1622,
      1831,24, 0,1,15,45,81,88,94,134,184,386,429,471,576,
               608,896,1040,1059,1082,1145,1168,1598,1618,1623,1675,
      1847,24, 0,1,28,36,89,126,151,189,397,539,661,671,684,741,787,838,910,
               1048,1057,1545,1626,1660,1681,1790,
      1861,25, 0,1,4,24,54,141,258,341,349,370,471,488,492,588,
               918,963,1259,1357,1358,1452,1499,1507,1518,1581,1737,
      1867,25, 0,1,5,21,40,50,62,64,136,285,309,468,476,541,831,842,
               845,986,1059,1196,1215,1288,1373,1458,1780,
      1871,25, 0,1,109,150,152,154,238,252,264,373,426,458,527,759,
               868,946,949,957,974,1036,1195,1294,1322,1470,1799,
      1873,25, 0,1,13,16,85,114,157,159,162,312,319,710,860,942,986,
               1137,1189,1226,1246,1276,1311,1538,1657,1693,1823,
      1877,25, 0,1,5,8,23,63,190,270,333,371,408,465,675,698,722,
               754,866,1228,1274,1277,1351,1385,1652,1744,1775,
      1879,25, 0,1,9,16,110,200,230,243,313,327,396,531,535,591,834,
               839,1123,1407,1408,1445,1470,1585,1613,1728,1747,
      1889,25, 0,1,5,46,82,103,116,179,183,291,409,497,781,880,888,
               936,983,1278,1298,1565,1673,1721,1732,1857,1861,
      1901,25, 0,1,5,7,18,58,134,157,257,521,622,638,787,896,1050,
               1084,1091,1094,1206,1312,1363,1504,1574,1672,1717,
      1907,25, 0,1,5,7,28,42,89,107,190,205,268,498,512,610,690,985,
               1065,1288,1294,1384,1655,1658,1665,1680,1762,
      1913,25, 0,1,2,4,12,93,101,116,234,272,380,397,463,659,895,
               1017,1206,1273,1301,1338,1711,1720,1727,1794,1870,
      1931,25, 0,1,8,45,51,69,91,117,428,458,469,493,505,584,603,606,
               662,806,874,880,956,1131,1366,1639,1734,
      1933,25, 0,1,7,47,94,131,164,181,317,336,344,445,619,789,885,
               917,945,947,1062,1411,1552,1636,1685,1749,1892,
      1949,25, 0,1,28,61,70,113,146,281,432,648,702,812,859,921,999,
               1001,1037,1047,1078,1120,1291,1354,1384,1483,1795,
      1951,25, 0,1,4,15,20,93,127,230,346,439,566,643,727,739,807,925,
               945,1426,1511,1521,1561,1642,1687,1795,1922,
      1973,25, 0,1,21,40,55,84,248,296,298,334,399,519,610,731,755,
               848,946,1048,1053,1230,1285,1296,1489,1604,1664,
      1979,25, 0,1,185,258,291,313,322,358,515,518,520,526,627,671,
               958,1057,1094,1120,1219,1266,1311,1360,1444,1620,1716,
      1987,25, 0,1,3,14,84,282,388,391,512,530,551,582,626,744,758,
               836,897,1042,1069,1075,1196,1344,1576,1622,1647,
      1993,25, 0,1,15,51,121,126,142,156,264,268,285,408,449,488,497,
               511,722,1009,1234,1333,1387,1430,1699,1789,1799,
      1997,25, 0,1,79,87,156,198,283,320,382,386,429,478,544,710,805,
               828,855,887,896,911,1289,1437,1450,1466,1488,
      1999,25, 0,1,2,4,32,55,87,114,160,199,256,356,388,393,458,632,
               652,699,920,999,1017,1093,1165,1510,1847,
        0 };

uint16_t aasscode[] = {
       17,3, 0,1,4,
       19,3, 0,1,8,
       23,4, 0,1,4,6,
       29,4, 0,1,4,8,
       31,4, 0,1,6,8,
       37,4, 0,1,6,10,
       41,4, 0,1,8,12,
       43,4, 0,1,8,32,
       47,4, 0,1,9,12,
       53,5, 0,1,4,8,16,
       59,5, 0,1,3,10,15,
       61,5, 0,1,8,12,24,
       67,5, 0,1,4,6,20,
       71,5, 0,1,9,18,21,
       73,5, 0,1,3,10,24,
       79,5, 0,1,12,15,21,
       83,5, 0,1,4,9,34,
       89,5, 0,1,4,20,30,
       97,5, 0,1,4,18,30,
      101,5, 0,1,20,29,33,
      103,5, 0,1,6,26,34,
      107,5, 0,1,7,25,35,
      109,6, 0,1,2,4,24,36,
      113,6, 0,1,2,8,24,36,
      127,6, 0,1,3,12,27,54,
131,6,0,1,4,6,24,52,
137,6,0,1,4,18,26,42,
139,6,0,1,4,6,24,56,
149,6,0,1,8,16,36,54,
151,6,0,1,3,7,29,47,
157,6,0,1,4,20,34,58,
163,6,0,1,4,10,36,54,
167,6,0,1,4,10,28,64,
173,6,0,1,4,14,44,66,
179,6,0,1,9,13,45,75,
181,6,0,1,6,36,54,68,
191,6,0,1,16,48,52,61,
193,6,0,1,4,12,51,80,
197,6,0,1,9,24,58,61,
199,6,0,1,38,50,54,122,
211,6,0,1,6,21,128,142,
223,7,0,1,4,6,12,50,75,
227,7,0,1,4,16,24,26,104,
229,7,0,1,6,9,36,54,108,
233,7,0,1,4,16,32,66,130,
239,7,0,1,3,6,12,38,148,
241,7,0,1,4,12,18,72,144,
251,7,0,1,8,10,16,72,112,
257,7,0,1,16,20,72,80,82,
263,7,0,1,8,32,48,100,150,
269,7,0,1,4,18,52,78,94,
271,7,0,1,4,10,40,72,88,
277,7,0,1,4,24,30,108,120,
281,7,0,1,6,9,20,76,114,
283,7,0,1,4,10,34,51,170,
293,7,0,1,6,20,48,88,104,
307,7,0,1,4,32,82,98,174,
311,7,0,1,8,25,38,96,188,
313,7,0,1,8,13,40,124,142,
317,7,0,1,4,14,33,74,127,
331,7,0,1,5,19,53,98,158,
337,7,0,1,9,48,81,107,110,
347,7,0,1,12,28,31,228,265,
349,8,0,1,6,16,20,72,108,116,
353,8,0,1,5,9,11,46,92,114,
359,8,0,1,4,10,18,72,164,174,
367,7,0,1,4,84,115,273,333,
373,8,0,1,4,16,32,42,100,134,
379,8,0,1,2,24,30,108,120,123,
383,8,0,1,6,16,35,43,89,159,
389,8,0,1,4,16,64,96,114,136,
397,8,0,1,3,7,24,36,120,180,
401,8,0,1,4,6,14,42,70,160,
409,8,0,1,10,14,22,88,142,240,
419,8,0,1,8,40,60,70,148,222,
421,8,0,1,8,12,18,33,126,189,
431,8,0,1,4,16,48,74,296,320,
433,8,0,1,3,18,48,102,312,321,
439,8,0,1,2,18,27,39,111,189,
443,8,0,1,4,18,27,83,117,171,
449,8,0,1,3,16,24,33,126,184,
457,8,0,1,4,12,18,49,121,194,
461,8,0,1,3,10,60,84,132,360,
463,8,0,1,4,12,76,114,158,176,
467,8,0,1,8,12,78,129,154,178,
479,8,0,1,4,48,66,108,229,283,
487,8,0,1,10,26,31,105,164,256,
491,8,0,1,6,37,45,93,183,204,
499,8,0,1,20,48,93,130,244,439,
503,8,0,1,10,34,104,106,276,282,
509,8,0,1,26,30,40,103,135,221,
521,8,0,1,3,214,318,334,370,442,
523,8,0,1,32,129,167,234,403,414,
541,8,0,1,22,34,48,111,231,314,
547,9,0,1,2,4,20,80,90,224,356,
557,9,0,1,4,16,44,80,98,356,390,
563,9,0,1,4,48,97,202,303,327,343,
569,9,0,1,4,34,56,76,172,180,332,
571,9,0,1,10,24,54,96,144,289,309,
577,9,0,1,4,12,22,50,144,238,282,
587,9,0,1,4,16,26,68,228,448,466,
593,9,0,1,10,16,28,96,200,248,348,
599,9,0,1,4,12,58,87,164,246,294,
601,9,0,1,2,16,40,140,204,332,338,
607,9,0,1,4,9,18,42,112,184,276,
613,9,0,1,4,42,44,100,188,210,218,
617,9,0,1,8,10,38,99,154,231,257,
619,9,0,1,8,26,54,57,127,362,476,
631,9,0,1,4,22,30,66,126,202,344,
641,9,0,1,8,13,48,93,146,223,247,
643,9,0,1,8,12,40,138,214,350,462,
647,9,0,1,9,11,15,65,155,380,475,
653,9,0,1,12,36,44,118,136,432,435,
659,9,0,1,4,20,30,130,138,214,310,
661,9,0,1,31,74,77,127,235,240,302,
673,9,0,1,6,25,43,107,178,267,275,
677,9,0,1,4,10,50,83,218,279,305,
683,9,0,1,40,56,65,244,306,311,335,
691,9,0,1,5,20,48,82,146,260,282,
701,9,0,1,44,57,79,202,209,227,242,
709,9,0,1,8,90,215,228,231,381,411,
719,9,0,1,13,36,78,81,218,249,521,
727,9,0,1,3,78,131,135,197,550,635,
733,9,0,1,4,12,78,107,193,236,401,
739,9,0,1,10,45,176,207,249,438,441,
743,9,0,1,24,27,86,220,294,362,396,
751,9,0,1,5,12,30,99,313,392,551,
757,9,0,1,9,69,116,555,560,562,587,
761,9,0,1,3,83,301,592,606,703,729,
769,9,0,1,67,75,111,399,544,595,605,
773,10,0,1,4,24,26,64,70,172,408,548,
787,10,0,1,3,13,30,110,165,171,228,441,
797,10,0,1,8,18,92,136,276,460,506,510,
809,10,0,1,14,28,63,96,99,101,310,366,
811,10,0,1,5,26,52,80,136,149,260,517,
821,10,0,1,6,14,56,73,112,406,630,632,
823,10,0,1,8,18,22,80,156,278,480,518,
827,10,0,1,4,16,37,110,165,264,324,356,
829,10,0,1,8,26,64,84,150,194,203,417,
839,10,0,1,3,30,51,66,155,308,320,452,
853,10,0,1,18,34,48,96,122,264,273,275,
857,10,0,1,3,10,24,94,148,243,506,542,
859,10,0,1,10,13,41,87,338,365,488,570,
863,10,0,1,3,13,39,57,188,282,427,803,
877,10,0,1,4,16,38,117,202,245,269,301,
881,10,0,1,4,25,36,72,88,290,299,463,
883,10,0,1,6,61,70,87,274,276,313,450,
887,10,0,1,12,22,98,270,284,362,668,848,
907,10,0,1,6,18,80,120,248,262,440,630,
911,10,0,1,26,29,114,238,245,250,305,315,
919,10,0,1,11,20,35,97,172,237,263,522,
929,10,0,1,7,23,54,133,210,213,321,357,
937,10,0,1,8,18,64,146,317,321,539,576,
941,10,0,1,13,70,105,277,319,631,787,806,
947,10,0,1,21,38,71,101,173,356,361,735,
953,10,0,1,11,50,74,166,236,389,773,775,
967,10,0,1,5,13,84,103,172,448,489,757,
971,10,0,1,7,10,122,182,324,450,470,600,
977,10,0,1,10,28,80,144,244,320,532,858,
983,10,0,1,17,24,53,118,312,315,557,566,
991,10,0,1,40,46,48,61,144,254,600,720,
997,10,0,1,19,41,75,80,421,452,759,870,
1009,10,0,1,5,55,147,237,332,408,795,852,
1013,10,0,1,60,84,112,194,214,532,664,680,
1019,10,0,1,6,29,92,428,475,628,687,702,
1021,10,0,1,8,21,72,89,185,407,580,645,
1031,10,0,1,13,107,148,269,534,559,625,1013,
1033,10,0,1,12,31,52,136,140,428,445,679,
1039,10,0,1,103,248,253,269,490,497,659,698,
1049,10,0,1,22,252,298,312,516,652,744,750,
1051,10,0,1,50,52,93,127,233,280,477,740,
1061,10,0,1,13,51,159,310,439,521,644,943,
1063,11,0,1,5,18,25,54,210,221,325,672,778,
1069,11,0,1,4,20,27,106,212,225,466,481,534,
1087,11,0,1,7,16,40,61,129,170,342,682,686,
1091,11,0,1,8,48,111,226,285,347,361,708,710,
1093,11,0,1,4,12,84,101,131,169,364,788,790,
1097,11,0,1,3,15,36,58,65,236,244,354,384,
1103,11,0,1,8,24,92,234,268,534,580,720,724,
1109,11,0,1,5,60,80,200,210,271,572,575,871,
1117,11,0,1,3,8,33,49,72,204,249,510,561,
1123,11,0,1,5,52,55,67,97,242,266,630,824,
1129,11,0,1,13,17,52,67,134,190,416,602,877,
1151,11,0,1,3,8,23,36,110,236,362,530,997,
1153,11,0,1,5,8,38,100,206,287,346,362,422,
1163,11,0,1,8,11,57,127,252,269,383,402,816,
1171,11,0,1,8,38,72,81,121,217,672,799,893,
1181,11,0,1,13,17,36,77,138,196,426,495,534,
1187,11,0,1,12,15,56,89,124,364,794,873,931,
1193,11,0,1,4,12,38,92,169,230,393,464,546,
1201,11,0,1,4,14,54,71,155,295,372,699,996,
1213,11,0,1,6,34,103,138,141,358,371,413,425,
1217,11,0,1,8,49,82,241,380,401,966,982,1027,
1223,11,0,1,6,18,60,62,209,472,702,766,860,
1229,11,0,1,8,14,40,85,174,228,315,652,681,
1231,11,0,1,36,74,99,236,277,280,355,539,941,
1237,11,0,1,75,79,143,329,331,743,756,764,857,
1249,11,0,1,22,28,31,102,236,301,324,442,460,
1259,11,0,1,60,104,110,138,142,298,808,1088,1108,
1277,11,0,1,4,41,72,87,105,322,336,806,900,
1279,11,0,1,6,24,56,170,185,388,415,509,1048,
1283,11,0,1,7,41,167,624,634,637,949,1018,1073,
1289,11,0,1,14,36,55,65,272,351,360,472,575,
1291,11,0,1,5,33,43,142,224,281,578,633,922,
1297,11,0,1,4,19,62,96,343,428,499,967,1192,
1301,11,0,1,30,43,66,68,204,235,355,724,1087,
1303,11,0,1,14,49,108,169,198,201,408,523,532,
1307,11,0,1,8,20,110,142,167,233,370,746,878,
1319,11,0,1,18,59,81,182,191,369,579,583,704,
1321,11,0,1,33,90,173,506,508,535,866,1030,1114,
1327,11,0,1,31,66,151,208,308,382,431,549,627,
1361,11,0,1,6,248,277,315,606,670,706,746,765,
1367,11,0,1,53,332,401,503,508,614,670,691,714,
1373,11,0,1,84,468,517,571,611,622,820,827,1151,
1381,11,0,1,10,62,155,220,394,418,541,939,1064,
1399,12,0,1,2,24,41,96,110,293,637,907,934,939,
1409,11,0,1,12,120,168,234,319,608,611,960,1028,
1423,12,0,1,8,26,52,107,130,179,303,367,682,881,
1427,12,0,1,4,42,70,172,203,247,434,464,524,556,
1429,12,0,1,10,29,85,108,167,184,382,438,600,813,
1433,12,0,1,46,55,104,118,238,248,276,552,604,1004,
1439,12,0,1,10,15,35,47,83,175,298,551,849,1072,
1447,12,0,1,4,28,70,82,104,156,220,648,866,1068,
1451,12,0,1,8,20,48,98,107,378,474,530,671,695,
1453,12,0,1,9,24,104,162,310,518,578,581,692,1377,
1459,12,0,1,16,20,72,134,332,340,406,437,505,1220,
1471,12,0,1,4,20,110,121,224,264,560,607,617,778,
1481,12,0,1,8,22,31,93,180,227,455,466,606,610,
1483,12,0,1,4,6,33,94,250,387,635,675,688,705,
1487,12,0,1,6,10,120,169,390,462,464,671,1346,1361,
1489,12,0,1,7,10,29,44,113,184,368,432,598,631,
1493,12,0,1,45,58,197,358,476,480,1110,1128,1244,1252,
1499,12,0,1,25,75,128,136,326,476,638,764,768,795,
1511,12,0,1,3,50,54,125,135,146,308,638,662,1251,
1523,12,0,1,3,14,26,57,193,212,336,488,815,1141,
1531,12,0,1,3,24,126,138,340,367,374,437,647,927,
1543,12,0,1,45,109,430,457,536,647,700,1241,1253,1258,
1549,12,0,1,6,47,118,156,284,343,378,516,1036,1067,
1553,12,0,1,20,26,89,118,480,625,661,1214,1222,1511,
1559,12,0,1,22,35,65,101,218,366,368,611,720,810,
1567,12,0,1,3,37,44,64,241,378,450,466,883,979,
1571,12,0,1,2,34,226,248,362,703,715,1304,1475,1544,
1579,12,0,1,27,107,174,299,371,375,381,770,1147,1451,
1583,12,0,1,11,19,56,65,234,361,429,674,731,755,
1597,12,0,1,8,21,38,70,239,331,375,429,1047,1290,
1601,12,0,1,3,16,61,100,152,280,484,608,657,698,
1607,12,0,1,29,46,87,112,120,398,400,549,646,1221,
1609,12,0,1,39,70,93,474,532,558,560,1236,1342,1416,
1613,12,0,1,6,40,100,198,243,481,595,834,846,869,
1619,12,0,1,10,22,82,106,159,228,398,632,724,1180,
1621,12,0,1,17,130,193,199,313,370,532,597,761,920,
1627,12,0,1,5,16,104,127,148,208,408,476,1096,1105,
1637,12,0,1,23,41,86,102,256,286,576,646,649,1298,
1657,12,0,1,8,30,226,228,243,387,398,526,926,1010,
1663,12,0,1,10,35,42,98,159,399,413,471,768,1102,
1667,12,0,1,17,42,80,127,320,353,390,519,650,920,
1669,12,0,1,29,48,104,159,498,698,817,925,1165,1261,
1693,12,0,1,16,22,71,149,188,406,459,479,950,1445,
1697,12,0,1,4,32,115,162,212,282,290,925,977,1405,
1699,12,0,1,31,50,95,116,266,488,525,994,1074,1524,
1709,12,0,1,4,124,330,408,422,476,516,560,1516,1688,
1721,12,0,1,10,80,241,265,291,420,544,962,983,1066,
1723,12,0,1,59,98,110,429,448,491,536,951,1040,1215,
1733,12,0,1,6,14,81,176,399,599,890,929,1226,1263,
1741,12,0,1,24,60,98,224,233,461,636,1209,1371,1488,
1747,12,0,1,48,294,310,352,382,718,800,1294,1319,1327,
1753,12,0,1,13,91,136,218,356,376,709,1083,1156,1497,
1759,12,0,1,10,63,100,138,379,448,559,1067,1250,1471,
1777,12,0,1,78,86,104,296,414,420,455,589,737,1005,
1783,12,0,1,117,343,389,990,1096,1330,1616,1625,1745,1767,
1787,12,0,1,55,139,200,237,271,324,667,676,689,1256,
1789,12,0,1,10,38,100,226,467,636,676,758,869,1419,
1801,12,0,1,89,134,140,150,530,544,1178,1335,1505,1508,
1811,12,0,1,30,356,573,616,647,692,749,879,1434,1733,
1823,13,0,1,4,24,76,93,197,311,405,443,642,915,1035,
1831,13,0,1,3,12,90,162,172,208,350,525,1194,1284,1377,
1847,13,0,1,10,29,34,70,165,372,383,553,645,650,836,
1861,13,0,1,4,22,27,39,63,132,289,413,870,1152,1400,
1867,13,0,1,6,16,24,43,50,190,295,515,630,780,898,
1871,13,0,1,13,38,43,62,95,247,326,471,637,1199,1203,
1873,13,0,1,7,23,106,212,224,436,483,795,816,1030,1782,
1877,13,0,1,16,21,28,92,115,117,242,536,745,771,909,
1879,13,0,1,24,54,183,345,355,481,483,591,598,690,1040,
1889,13,0,1,20,38,47,144,159,360,526,550,644,824,831,
1901,13,0,1,40,141,143,201,334,350,491,604,803,919,1779,
1907,13,0,1,22,26,80,210,281,542,642,669,938,1615,1815,
1913,13,0,1,16,24,26,75,102,115,435,737,1208,1438,1803,
1931,13,0,1,12,15,83,100,209,368,612,642,954,1049,1697,
1933,13,0,1,24,34,62,126,212,462,464,634,1000,1742,1796,
1949,13,0,1,168,184,262,298,366,1000,1002,1334,1552,1556,1640,
1951,13,0,1,5,22,24,99,465,682,689,742,753,869,1627,
1973,13,0,1,12,35,120,291,556,573,577,623,705,907,916,
1979,13,0,1,10,35,37,98,111,378,486,626,914,979,1169,
1987,13,0,1,17,65,67,96,169,243,394,526,559,869,1059,
1993,13,0,1,31,35,68,90,146,248,365,379,718,915,955,
1997,13,0,1,11,46,78,134,422,676,680,695,1115,1157,1240,
1999,13,0,1,4,25,36,125,224,516,1116,1161,1462,1763,1796,

        0 };

uint16_t * findcode(int type, int p)
{
    uint16_t * t;
    t=NULL;
    if(type==2) t=ascode;
    if(type==3) t=aascode;
    if(type==4) t=aasscode;
    if(t==NULL)
    {
        printf("Code type not (yet) defined\n");
        exit(1);
    }
    while(1)
    {
        if(t[0]==0) break;
        if(t[0]==p) return t;
        t+=(t[1]+2);    
    }
    printf("Code type %d for prime %d not found\n",type,p);
    exit(2);
}

void getcode(int type, int p, uint16_t * code)
{
    uint16_t * t;
    int i,len;
    t=NULL;
    if(type==2) t=ascode;
    if(type==3) t=aascode;
    if(type==4) t=aasscode;
    if(t==NULL)
    {
        printf("Code type not (yet) defined\n");
        exit(1);
    }
    while(1)
    {
        if(t[0]==0) break;
        len=t[1];
        if(t[0]==p)
        {
            for(i=0;i<=len;i++)  code[i]=t[i+1];
            return;
        }
        t+=(len+2);    
    }
    printf("Code type %d for prime %d not found\n",type,p);
    exit(2);
}

int mkatab(int type, int p, uint8_t * tab)
{
    uint16_t * code;
    int i,i1,j,j1,k,len;
    code=findcode(type,p)+1;
    switch(type)
    {
      case 2:
        for(i=0;i<p;i++)
            tab[2*i]=255;
        len=code[0];
        for(i=0;i<len;i++)
            for(j=0;j<len;j++)
            {
                k=20*p+code[i+1]-code[j+1];
                k=k%p;
                if(tab[2*k]==255)
                {
                    tab[2*k]=i;
                    tab[2*k+1]=j;
                }
            }
        for(i=0;i<p;i++) if(tab[2*i]==255) break;
        if(i!=p)
        {
            printf("AS table failed - can't make %d mod %d\n",i,p);
            exit(3);
        }
        return 2*p;
      case 3:
        for(i=0;i<p;i++)
            tab[3*i]=255;
        len=code[0];
        for(i=0;i<len;i++)
          for(j=0;j<len;j++)
            for(i1=0;i1<len;i1++)
              {
                  k=20*p+code[i+1]+code[i1+1]-code[j+1];
                  k=k%p;
                  if(tab[3*k]==255)
                  {
                      tab[3*k]=i;
                      tab[3*k+1]=j;
                      tab[3*k+2]=i1;
                  }
              }
        for(i=0;i<p;i++) if(tab[3*i]==255) break;
        if(i!=p)
        {
            printf("AAS table failed - can't make %d mod %d\n",i,p);
            exit(3);
        }
        return 3*p;
      case 4:
        for(i=0;i<p;i++)
            tab[4*i]=255;
        len=code[0];
        for(i=0;i<len;i++)
          for(j=0;j<len;j++)
            for(i1=0;i1<len;i1++)
              for(j1=0;j1<len;j1++)
                {
                    k=20*p+code[i+1]+code[i1+1]
                      -code[j+1]-code[j1+1];
                    k=k%p;
                    if(tab[4*k]==255)
                    {
                        tab[4*k]=i;
                        tab[4*k+1]=j;
                        tab[4*k+2]=i1;
                        tab[4*k+3]=j1;
                    }
                }
        for(i=0;i<p;i++) if(tab[4*i]==255) break;
        if(i!=p)
        {
            printf("AASS table failed - can't make %d mod %d\n",i,p);
            exit(3);
        }
        return 4*p;
      default:
        printf("AS table failed - no such type as %d\n",type);
        exit(3);
    }
}

int addchain(int type, int p,  uint8_t * adc)
{
    int c[100];
    uint16_t * code;
    int i,j,k,len,big,bigx,top,nex,sbig,sbigx;
    code=findcode(type,p)+1;
    len=code[0];
    for(i=0;i<len;i++)  c[i]=code[i+1];
    nex=3*len-6;
    top=nex;
    adc[nex]=0;
    while(1)
    {
        big=1;
        bigx=-1;
// locate largest number
        for(i=0;i<len;i++)
        {
            if(c[i]>big)
            {
                big=c[i];
                bigx=i;
            }
        }
        if(big==1) return top+1;
// see if it is the sum of two smaller
        for(j=1;j<len;j++)
        {
            if(j==bigx) continue;
            for(k=j;k<len;k++)
            {
                if(k==bigx) continue;
                if( (c[j]+c[k])==big ) break;
            }
            if(k<len) break;
        }
        if(j<len)   // yes it is - make it like that
        {
            adc[nex-3]=j;
            adc[nex-2]=k;
            adc[nex-1]=bigx;
            c[bigx]=0;
            nex-=3;
            continue;
        }
// locate second largest
        sbig=1;
        sbigx=-1;
        for(i=0;i<len;i++)
        {
            if(c[i]==big) continue;
            if(c[i]>sbig)
            {
                sbig=c[i];
                sbigx=i;
            }
        }
// If second largest more than half, add that
        if( (2*sbig)>big )
        {
            for(i=top;i>=nex;i--) adc[i+3]=adc[i];
            top+=3;
            adc[nex]=sbigx;
            adc[nex+1]=bigx;
            adc[nex+2]=bigx;
            c[bigx]=big-sbig;
            continue;
        }
// If biggest is even, make it by doubling
        if((big%2)==0)
        {
            for(i=top;i>=nex;i--) adc[i+3]=adc[i];
            top+=3;
            adc[nex]=bigx;
            adc[nex+1]=bigx;
            adc[nex+2]=bigx;
            c[bigx]=big/2;
            continue;
        }
// locate second largest odd number
        sbig=0;
        sbigx=-1;
        for(i=0;i<len;i++)
        {
            if(c[i]==big) continue;
            if( (c[i]%2)!=1 ) continue;
            if(c[i]>sbig)
            {
                sbig=c[i];
                sbigx=i;
            }

        }
// Subtract the largest other odd number if there is one
        if(sbig!=0)
        {
            for(i=top;i>=nex;i--) adc[i+3]=adc[i];
            top+=3;
            adc[nex]=sbigx;
            adc[nex+1]=bigx;
            adc[nex+2]=bigx;
            c[bigx]=big-sbig;
            continue;
        }
        printf("Purbeck chain failed\n");
        exit(4);
    }
}

/* end of gcodes.c  */
