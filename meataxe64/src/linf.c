/*   linf.c Linear Forms module   */
/*   R. A. Parker 24.9.2016       */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>
#include "field.h"
#include "hpmi.h"
#include "pcrit.h"
#include "slab.h"
#include "linf.h"
#include "pmul.h"

// interpreted programs for linear forms 

uint8_t lfAKa[] = { 2,0,1,2,  0 };  //  0 1 0+1
uint8_t lfZKa[] = { 3,2,0,2 , 3,2,1,2 , 9,1,2   , 4,2,0 , 5,2,1 , 0};
uint8_t lfACu[] = { 2,0,2,3 , 1,3,4   , 3,3,1,3 , 2,4,1,1 , 3,4,3,4 ,
                    2,4,1,4 , 7,3,2,4 , 0};
uint8_t lfZCu[] = { 3,1,3,1 ,11,4,3,4 , 10,2,1    , 2,3,1,3 , 7,3,0,4,
                    3,3,0,3 , 3,3,2,3 , 11,12,2,4 , 11,6,1,4 ,
               10,6,4 , 3,1,4,1 , 9,2,3  , 4,4,0 , 4,3,1 , 5,4,1 , 5,3,2, 0};
uint8_t lfA8[]  = {  2,1,2,4 , 2,0,4,5 , 2,0,1,3 , 0 };
uint8_t lfZ8[]  = {  2,4,2,2 , 2,0,4,4 , 2,1,0,0 , 1,4,1 , 2,2,0,0 ,
                     2,5,2,2 , 2,3,1,1 , 2,3,2,2 , 0 };
uint8_t lfA16[] = {  2,0,1,4 , 2,0,2,6 , 2,1,3,7 , 2,2,3,5 , 2,4,5,8 ,
                     0 };
uint8_t lfZ16[] = {  2,2,1,1 , 2,1,0,0 , 2,0,5,5 , 2,3,0,0 , 1,8,3 ,
                     2,7,0,0 , 2,7,4,4 , 2,6,1,1 , 2,5,6,6 , 2,6,2,2 ,
                     2,4,6,6 , 2,6,1,1 , 2,6,3,3 , 0 };
uint8_t lfA27[] = {  2,0,1,3 , 2,2,3,4 , 2,1,4,5 , 0 };
uint8_t lfZ27[] = {  3,3,1,3 , 1,5,1 , 9,2,4 , 3,1,2,1 , 3,2,0,2 ,
                     1,3,0 , 3,2,1,2 , 3,0,1,0 , 3,1,4,1 , 0 };
uint8_t lfA32[]  = {  2,4,1,1 , 2,1,3,9 , 2,3,2,2 , 2,0,2,5 , 2,5,9,7 ,
                      2,4,7,12 , 2,2,12,11 , 2,3,12,10 , 2,1,11,6 , 2,0,10,8 ,
                      0 };
uint8_t lfZ32[]  = {  2,0,2,2 , 2,1,0,0 , 1,12,1 , 2,9,10,10 , 2,6,9,9 ,
                      2,1,2,2 , 2,2,8,8 , 2,10,2,2 , 2,9,4,4 , 2,4,1,1 ,
                      2,11,0,0 , 2,11,1,1 , 2,8,0,0 , 2,8,9,9 , 2,3,4,4 ,
                      2,9,3,3 , 2,2,4,4 , 2,7,1,1 , 2,7,3,3 , 2,5,0,0 ,
                      2,5,2,2 , 0 };
uint8_t lfA64[]  = {  2,5,2,2 , 2,4,1,1 , 2,0,1,9 , 2,2,4,4 , 2,0,2,2 ,
                   1,4,8 , 2,2,9,4 , 2,2,3,3 , 2,1,5,13 , 2,3,1,1 ,
                   2,8,9,11 , 2,2,13,12 , 2,3,12,7 , 2,7,8,10 , 2,7,9,6 ,
                   2,5,10,16 , 2,12,16,17 , 2,2,17,14 , 1,2,15 , 1,5,2 ,
                   2,3,4,5 , 0 };
uint8_t lfZ64[]  = {  2,8,11,11 , 2,16,12,12 , 2,7,8,8 , 2,8,4,4 , 2,15,12,12 ,
                   2,6,12,12 , 9,2,3 , 2,12,0,0 , 2,10,3,3 , 2,3,4,4 ,
                   2,4,2,2 , 2,5,4,4 , 1,16,5 , 2,6,2,2 , 2,13,10,10 ,
                   2,0,11,11 , 2,4,0,0 , 2,10,4,4 , 2,4,5,5 , 2,14,4,4 ,
                   2,12,3,3 , 2,15,4,4 , 2,8,5,5 , 2,11,1,1 , 2,11,4,4 ,
                   2,1,5,5 , 2,17,5,5 , 2,9,3,3 , 2,9,4,4 , 0 };
uint8_t lfA81[]  = {  2,0,1,4 , 2,2,3,5 , 2,4,5,8 , 2,0,2,6 , 2,1,3,7 ,
                      0 };
uint8_t lfZ81[]  = {  2,1,3,3 , 3,0,3,0 , 2,0,2,2 , 3,3,4,3 , 2,7,0,0 ,
                      2,2,1,1 , 3,6,2,6 , 1,6,2 , 2,3,1,1 , 2,8,3,3 ,
                      2,5,0,0 , 3,5,1,5 , 1,5,1 , 3,3,2,3 , 0 };
uint8_t lfA128[]  = {  2,2,4,4 , 1,1,20 , 2,4,1,1 , 2,5,6,18 , 2,18,4,4 ,
                   9,5,18 , 1,6,14 , 2,0,5,6 , 2,6,2,2 , 2,3,6,6 ,
                   1,4,8 , 2,1,18,4 , 2,0,20,21 , 2,6,1,1 , 2,2,3,3 ,
                   1,5,19 , 2,3,4,5 , 2,2,4,9 , 2,8,9,11 , 2,6,11,10 ,
                   2,10,19,16 , 2,6,9,7 , 2,7,21,17 , 2,16,17,12 , 2,2,12,13 ,
                   1,2,15 , 1,14,2 , 2,13,16,14 , 0 };
uint8_t lfZ128[]  = {  2,12,8,8 , 2,5,12,12 , 1,2,5 , 1,15,2 , 9,0,1 ,
                   9,3,4 , 2,6,13,13 , 2,19,18,18 , 2,21,20,20 , 2,14,13,13 ,
                   2,14,17,17 , 2,13,2,2 , 2,13,16,16 , 2,16,10,10 , 2,10,9,9 ,
                   2,7,10,10 , 2,8,10,10 , 2,11,8,8 , 2,2,16,16 , 2,18,3,3 ,
                   2,17,1,1 , 2,17,8,8 , 2,8,2,2 , 2,20,2,2 , 2,20,3,3 ,
                   2,1,12,12 , 2,9,1,1 , 2,9,16,16 , 2,3,4,4 , 2,12,3,3 ,
                   2,5,4,4 , 2,16,5,5 , 2,0,5,5 , 2,8,6,6 , 2,5,6,6 ,
                   2,1,2,2 , 2,18,5,5 , 2,0,3,3 , 2,10,0,0 , 2,10,4,4 ,
                   0 };
uint8_t lfA243[]  = {  2,0,4,7 , 3,2,1,10 , 3,7,2,7 , 2,0,1,6 , 3,10,7,10 ,
                       3,1,3,8 , 3,3,10,3 , 2,8,2,2 , 2,7,8,9 , 3,8,10,5 ,
                       3,10,6,10 , 2,2,10,11 , 0 };
uint8_t lfZ243[]  = {  3,6,1,6 , 1,2,1 , 1,4,2 , 1,7,4 , 9,0,6 ,
                       3,4,5,4 , 2,4,8,8 , 3,9,8,9 , 2,9,0,0 , 3,0,3,0 ,
                       3,5,2,5 , 2,11,2,2 , 3,6,3,6 , 2,5,3,3 , 2,0,1,1 ,
                       3,10,3,10 , 3,2,1,2 , 2,10,1,1 , 3,4,6,4 , 2,9,3,3 ,
                       2,8,4,4 , 3,2,6,2 , 0 };
uint8_t lfA256[]  = {  2,4,3,3 , 2,5,3,3 , 1,1,25 , 2,2,1,1 , 2,4,1,1 ,
                   2,6,4,4 , 1,2,23 , 2,7,2,2 , 1,4,10 , 2,5,4,4 ,
                   2,4,25,17 , 2,23,4,4 , 2,5,7,24 , 2,6,7,12 , 2,3,7,21 ,
                   2,0,21,21 , 2,21,10,10 , 2,10,2,2 , 2,1,3,20 , 2,25,3,3 ,
                   9,5,25 , 2,1,24,8 , 2,10,1,1 , 2,0,23,22 , 2,3,4,14 ,
                   2,17,20,18 , 2,2,8,9 , 2,3,10,13 , 2,4,13,15 , 2,18,21,19 ,
                   2,17,19,16 , 9,4,12 , 9,2,7 , 1,3,11 , 1,6,3 ,
                   2,0,5,6 , 0 };
uint8_t lfZ256[]  = {  9,0,5 , 9,2,7 , 9,3,23 , 2,22,3,3 , 2,24,25,25 ,
                   2,25,16,16 , 2,18,4,4 , 2,4,21,21 , 2,6,1,1 , 2,21,16,16 ,
                   2,21,20,20 , 2,3,19,19 , 2,19,20,20 , 2,20,14,14 , 2,15,10,10 ,
                   2,15,14,14 , 2,12,10,10 , 2,12,13,13 , 2,10,2,2 , 2,11,13,13 ,
                   2,11,14,14 , 2,7,16,16 , 2,23,7,7 , 2,23,14,14 , 2,2,8,8 ,
                   2,9,2,2 , 2,16,13,13 , 2,17,19,19 , 2,8,16,16 , 9,1,14 ,
                   2,8,5,5 , 2,0,16,16 , 2,16,3,3 , 2,16,4,4 , 2,14,0,0 ,
                   2,14,1,1 , 2,7,4,4 , 2,7,5,5 , 1,20,7 , 2,5,7,7 ,
                   2,25,5,5 , 2,4,10,10 , 2,19,4,4 , 2,2,7,7 , 2,0,2,2 ,
                   2,6,7,7 , 2,18,6,6 , 2,1,5,5 , 2,10,6,6 , 2,13,0,0 ,
                   2,13,4,4 , 0 };
uint8_t lfZ343[]  = {  9,0,2 , 6,3,2 , 7,4,4,3 , 3,0,3,0 , 7,5,0,2 ,
                   2,2,1,1 , 3,0,4,0 , 7,2,1,0 , 7,3,3,2 , 0 };
uint8_t lfA512[]  = {  2,5,3,3 , 1,4,12 , 2,7,4,4 , 2,12,5,5 , 2,3,12,12 ,
                   1,7,18 , 2,8,7,7 , 2,1,12,12 , 9,1,12 , 1,12,20 ,
                   2,6,8,24 , 2,24,5,5 , 2,5,8,23 , 2,2,23,23 , 9,2,23 ,
                   2,1,4,27 , 2,24,4,4 , 2,2,3,14 , 2,0,3,3 , 2,24,3,3 ,
                   2,1,14,29 , 2,8,1,1 , 2,3,4,17 , 2,29,4,4 , 1,6,25 ,
                   2,3,7,6 , 2,23,3,3 , 2,5,6,28 , 2,20,5,5 , 2,0,23,22 ,
                   2,0,20,21 , 2,1,2,10 , 1,7,19 , 2,28,29,7 , 2,6,10,11 ,
                   2,5,14,16 , 2,7,27,26 , 2,1,6,9 , 2,14,17,15 , 2,5,15,12 ,
                   9,1,7 , 9,2,8 , 1,5,13 , 2,3,4,5 , 0 };
uint8_t lfZ512[]  = {  9,2,5 , 9,1,4 , 9,0,14 , 2,25,24,24 , 2,4,17,17 ,
                   9,4,6 , 9,3,12 , 2,23,22,22 , 2,29,28,28 , 2,24,10,10 ,
                   2,10,7,7 , 2,7,18,18 , 2,20,21,21 , 2,20,22,22 , 2,22,11,11 ,
                   2,11,18,18 , 9,5,8 , 2,28,14,14 , 2,8,7,7 , 2,27,21,21 ,
                   2,15,0,0 , 2,15,3,3 , 2,18,16,16 , 2,16,3,3 , 2,16,17,17 ,
                   2,17,0,0 , 2,17,13,13 , 2,26,12,12 , 2,14,5,5 , 2,14,18,18 ,
                   2,12,1,1 , 2,12,2,2 , 2,13,19,19 , 2,9,10,10 , 2,7,26,26 ,
                   2,19,5,5 , 2,21,10,10 , 2,21,13,13 , 2,5,4,4 , 2,10,5,5 ,
                   2,27,7,7 , 2,0,11,11 , 2,11,6,6 , 2,3,26,26 , 2,26,4,4 ,
                   2,28,26,26 , 2,26,24,24 , 2,3,5,5 , 2,22,3,3 , 2,6,5,5 ,
                   2,1,19,19 , 2,18,1,1 , 2,18,3,3 , 2,6,7,7 , 2,24,6,6 ,
                   2,7,8,8 , 2,19,7,7 , 2,2,8,8 , 2,13,2,2 , 2,11,8,8 ,
                   2,26,8,8 , 2,13,3,3 , 0 };

uint8_t lfA625[]  = {  2,2,3,4 , 3,1,3,7 , 2,4,1,1 , 2,1,4,5 , 2,2,5,6 ,
                   2,0,1,1 , 2,1,6,6 , 2,6,7,7 , 2,7,5,5 , 0 };
uint8_t lfZ625[]  = {  3,4,2,4 , 1,0,2 , 1,5,0 , 2,7,6,6 , 3,2,6,2 ,
                   2,2,3,3 , 3,3,1,3 , 3,0,3,0 , 3,3,7,3 , 6,2,0 ,
                   2,4,1,1 , 3,3,1,3 , 3,1,3,1 , 3,4,0,4 , 9,2,4 ,
                   3,2,6,2 , 7,2,2,3 , 7,2,4,2 , 0 };
uint8_t lfA729[]  = {  2,4,5,14 , 3,1,3,1 , 3,1,5,1 , 3,1,2,11 , 3,1,14,1 ,
                   1,5,6 , 3,11,2,5 , 2,3,2,2 , 1,2,7 , 2,0,2,2 ,
                   1,4,13 , 3,2,13,4 , 3,2,1,2 , 2,4,3,3 , 2,1,13,8 ,
                   2,3,1,1 , 2,1,7,7 , 2,7,8,9 , 3,3,11,10 , 1,3,12 ,
                   1,6,3 , 2,4,5,6 , 0 };
uint8_t lfZ729[]  = {  3,14,13,14 , 1,0,13 , 1,2,0 , 1,9,2 , 2,11,12,12 ,
                   2,10,11,11 , 9,1,12 , 2,12,6,6 , 3,3,0,3 , 2,6,5,5 ,
                   3,4,6,4 , 2,5,0,0 , 2,5,1,1 , 1,11,5 , 2,1,3,3 ,
                   3,1,4,1 , 2,5,2,2 , 2,5,0,0 , 3,12,3,12 , 3,3,7,3 ,
                   3,3,2,3 , 3,2,3,2 , 2,8,3,3 , 2,13,3,3 , 3,1,13,1 ,
                   2,4,12,12 , 3,3,1,3 , 2,12,4,4 , 3,5,12,5 , 2,14,2,2 ,
                   2,14,4,4 , 0 };
uint8_t lfA1024[]  = {  2,6,3,3 , 2,5,4,4 , 2,6,5,5 , 2,7,6,6 , 2,7,9,33 ,
                   1,7,34 , 2,8,7,7 , 1,8,25 , 2,9,8,8 , 2,6,7,11 ,
                   2,6,33,32 , 2,4,32,32 , 2,2,32,32 , 2,1,4,4 , 2,2,7,7 ,
                   9,2,32 , 2,3,5,18 , 2,25,5,5 , 2,3,4,29 , 2,7,4,4 ,
                   2,9,7,7 , 2,0,6,6 , 2,1,6,21 , 2,18,6,6 , 2,2,18,18 ,
                   2,5,32,24 , 2,21,5,5 , 2,29,21,21 , 2,29,11,11 , 2,3,11,17 ,
                   2,33,3,3 , 2,6,7,7 , 2,5,33,26 , 2,18,5,5 , 1,6,10 ,
                   2,0,1,6 , 2,0,32,31 , 2,3,24,27 , 2,17,18,20 , 2,26,27,30 ,
                   2,3,29,23 , 2,18,21,19 , 2,23,26,22 , 2,10,11,13 , 2,22,24,28 ,
                   2,2,11,14 , 2,17,19,16 , 2,2,13,15 , 9,1,5 , 9,4,8 ,
                   9,3,25 , 1,2,12 , 1,9,2 , 2,7,8,9 , 0 };
uint8_t lfZ1024[]  = {  9,2,32 , 9,1,25 , 9,3,5 , 2,34,33,33 , 2,31,2,2 ,
                   2,10,9,9 , 2,9,29,29 , 2,32,20,20 , 2,20,15,15 , 2,27,1,1 ,
                   2,27,22,22 , 2,22,25,25 , 9,6,10 , 2,10,2,2 , 2,10,3,3 ,
                   2,16,18,18 , 2,16,19,19 , 2,30,1,1 , 2,30,24,24 , 2,26,1,1 ,
                   2,26,29,29 , 2,29,0,0 , 2,23,1,1 , 2,23,28,28 , 2,33,4,4 ,
                   2,33,5,5 , 2,4,13,13 , 2,13,11,11 , 2,13,14,14 , 2,11,12,12 ,
                   2,11,15,15 , 2,15,8,8 , 2,14,7,7 , 2,28,8,8 , 2,3,25,25 ,
                   2,17,18,18 , 2,17,21,21 , 2,19,24,24 , 2,19,21,21 , 9,5,29 ,
                   2,7,29,29 , 2,7,4,4 , 2,15,5,5 , 2,29,2,2 , 2,21,6,6 ,
                   2,21,29,29 , 2,29,3,3 , 2,29,9,9 , 2,25,0,0 , 2,1,25,25 ,
                   2,18,1,1 , 2,24,8,8 , 2,2,24,24 , 2,24,1,1 , 9,2,25 ,
                   2,25,2,2 , 2,25,6,6 , 2,4,28,28 , 2,32,7,7 , 2,12,4,4 ,
                   2,12,14,14 , 2,24,5,5 , 2,9,7,7 , 2,28,20,20 , 2,28,22,22 ,
                   2,22,6,6 , 2,20,24,24 , 2,14,5,5 , 2,14,6,6 , 2,19,9,9 ,
                   2,2,7,7 , 2,0,2,2 , 2,3,24,24 , 2,0,4,4 , 2,22,9,9 ,
                   2,8,0,0 , 2,1,3,3 , 2,8,1,1 , 2,2,8,8 , 2,18,9,9 ,
                   2,24,8,8 , 2,24,9,9 , 0 };

uint8_t lfA2048[]  = {  2,9,5,5 , 2,9,4,4 , 2,10,9,9 , 2,6,10,34 , 2,3,34,34 ,
                   2,4,34,34 , 2,2,34,34 , 2,7,3,3 , 9,2,34 , 2,7,9,31 ,
                   2,4,31,31 , 2,8,4,4 , 2,9,10,27 , 2,1,31,31 , 9,1,31 ,
                   2,6,7,15 , 2,9,6,6 , 1,10,11 , 2,4,10,10 , 2,15,4,4 ,
                   2,5,15,15 , 1,11,14 , 2,34,15,15 , 2,0,15,15 , 2,3,5,36 ,
                   2,8,3,3 , 2,8,14,29 , 2,36,6,6 , 1,10,30 , 2,3,6,10 ,
                   2,0,6,6 , 2,10,29,21 , 2,36,21,21 , 2,31,36,36 , 2,7,10,13 ,
                   2,1,13,13 , 2,34,10,10 , 2,30,7,7 , 2,10,30,30 , 2,1,7,38 ,
                   2,10,38,38 , 2,38,4,4 , 2,7,27,18 , 2,0,18,18 , 2,36,7,7 ,
                   2,1,5,5 , 2,15,3,3 , 2,3,1,1 , 9,8,30 , 1,5,19 ,
                   2,3,4,5 , 2,0,34,33 , 2,0,31,32 , 2,1,38,37 , 1,10,20 ,
                   2,7,8,10 , 2,18,19,22 , 2,19,21,25 , 2,20,21,23 , 2,18,20,24 ,
                   2,2,15,17 , 2,2,13,16 , 2,1,36,35 , 2,13,15,12 , 2,6,10,11 ,
                   2,22,23,26 , 1,9,28 , 2,6,7,9 , 9,2,14 , 0 };
uint8_t lfZ2048[]  = {  9,1,6 , 2,30,29,29 , 2,33,34,34 , 2,13,19,19 , 2,37,38,38 ,
                   2,8,6,6 , 2,5,19,19 , 9,8,10 , 2,4,22,22 , 2,9,16,16 ,
                   2,20,21,21 , 2,20,26,26 , 2,2,27,27 , 2,34,31,31 , 2,34,32,32 ,
                   2,22,21,21 , 2,22,25,25 , 2,29,27,27 , 2,29,28,28 , 2,16,12,12 ,
                   2,16,17,17 , 2,23,18,18 , 2,23,21,21 , 2,12,14,14 , 2,12,15,15 ,
                   2,14,24,24 , 2,17,21,21 , 2,28,35,35 , 2,18,15,15 , 2,35,36,36 ,
                   2,35,38,38 , 2,19,21,21 , 2,19,24,24 , 2,11,1,1 , 2,11,8,8 ,
                   2,8,0,0 , 9,8,13 , 2,21,6,6 , 2,21,13,13 , 2,32,6,6 ,
                   2,32,15,15 , 2,27,1,1 , 2,27,9,9 , 2,26,36,36 , 2,36,2,2 ,
                   2,36,14,14 , 2,9,13,13 , 2,31,25,25 , 2,15,2,2 , 2,15,31,31 ,
                   2,25,3,3 , 2,24,25,25 , 9,7,18 , 2,13,24,24 , 9,6,14 ,
                   2,14,0,0 , 2,14,2,2 , 2,14,24,24 , 2,1,2,2 , 2,18,1,1 ,
                   2,4,5,5 , 2,24,4,4 , 9,3,26 , 2,10,18,18 , 2,26,3,3 ,
                   9,1,25 , 2,28,7,7 , 2,28,26,26 , 2,25,1,1 , 2,25,6,6 ,
                   2,25,26,26 , 2,26,5,5 , 2,31,17,17 , 2,17,6,6 , 2,17,8,8 ,
                   2,5,18,18 , 2,31,4,4 , 2,31,5,5 , 9,7,18 , 2,0,18,18 ,
                   2,32,9,9 , 2,18,7,7 , 2,27,8,8 , 2,27,26,26 , 2,26,9,9 ,
                   2,26,10,10 , 2,8,9,9 , 2,18,8,8 , 2,5,10,10 , 2,13,10,10 ,
                   2,0,5,5 , 2,4,10,10 , 2,38,0,0 , 2,3,4,4 , 2,38,2,2 ,
                   2,38,3,3 , 2,2,8,8 , 2,6,9,9 , 2,38,6,6 , 2,2,6,6 ,
                   2,0,2,2 , 2,1,7,7 , 2,36,10,10 , 0 };

uint8_t lfA2187[]  = {  2,6,4,4 , 2,5,1,1 , 3,2,6,2 , 3,1,3,8 , 3,1,4,1 ,
                   3,6,3,15 , 3,15,5,13 , 2,0,13,13 , 2,2,5,5 , 2,8,5,5 ,
                   3,4,1,4 , 2,5,4,4 , 2,2,5,11 , 2,4,2,2 , 2,13,4,4 ,
                   3,1,15,14 , 3,15,2,15 , 2,13,14,16 , 2,4,1,1 , 2,4,3,3 ,
                   2,2,16,7 , 3,3,11,10 , 2,10,2,2 , 2,7,8,9 , 2,15,16,17 ,
                   2,14,17,18 , 1,3,12 , 1,6,3 , 2,4,5,6 , 0 };
uint8_t lfZ2187[]  = {  9,1,18 , 2,5,18,18 , 2,18,4,4 , 3,16,14,16 , 2,4,0,0 ,
                   2,3,11,11 , 2,9,8,8 , 3,7,9,7 , 2,2,11,11 , 2,11,10,10 ,
                   2,11,12,12 , 3,1,17,1 , 2,8,2,2 , 3,13,17,13 , 3,5,3,5 ,
                   2,13,3,3 , 2,7,12,12 , 3,5,8,5 , 3,2,0,2 , 3,0,12,0 ,
                   3,3,12,3 , 3,6,12,6 , 3,7,10,7 , 2,7,1,1 , 2,4,6,6 ,
                   2,2,4,4 , 2,10,2,2 , 2,3,4,4 , 2,15,2,2 , 3,15,7,15 ,
                   2,15,3,3 , 3,15,7,15 , 2,1,6,6 , 2,6,5,5 , 3,1,16,1 ,
                   3,2,16,2 , 3,6,4,6 , 2,16,4,4 , 2,0,6,6 , 2,5,6,6 ,
                   2,18,6,6 , 3,5,15,5 , 0 };
uint8_t lfA2401[]  = {  2,0,2,4 , 7,3,1,2 , 1,2,6 , 3,4,3,2 , 2,3,4,4 ,
                   2,2,6,5 , 3,2,1,2 , 2,4,1,1 , 7,3,6,4 , 2,1,6,6 ,
                   9,2,3 , 0 };
uint8_t lfZ2401[]  = {  9,1,5 , 6,5,5 , 2,1,5,5 , 9,0,5 , 2,6,0,0 ,
                   7,5,3,2 , 3,3,5,3 , 2,6,5,5 , 3,3,2,3 , 7,3,0,2 ,
                   7,4,3,0 , 7,3,4,2 , 3,1,2,1 , 7,4,2,4 , 7,4,5,2 ,
                   3,3,2,3 , 2,4,2,2 , 0 };
uint8_t lfA3125[]  = {  2,2,4,7 , 2,3,4,10 , 2,10,1,1 , 3,7,1,7 , 3,3,1,8 ,
                   2,0,2,2 , 2,2,1,1 , 7,3,7,2 , 1,4,5 , 2,7,4,4 ,
                   7,3,8,7 , 2,0,4,4 , 1,3,9 , 3,2,8,3 , 2,2,8,8 ,
                   3,8,7,6 , 2,10,2,2 , 0 };
uint8_t lfZ3125[]  = {  3,10,9,10 , 1,0,9 , 1,6,0 , 9,2,3 , 2,3,2,2 ,
                   2,2,9,9 , 3,0,9,0 , 2,4,8,8 , 2,1,4,4 , 7,3,4,5 ,
                   3,1,5,1 , 7,3,10,0 , 3,5,10,5 , 2,0,7,7 , 2,7,0,0 ,
                   2,7,8,8 , 6,4,4 , 3,4,9,4 , 7,3,1,3 , 2,8,0,0 ,
                   2,8,1,1 , 7,2,2,3 , 7,3,5,2 , 0 };
uint8_t lfA4096[]  = {  2,9,3,3 , 2,10,6,6 , 2,11,5,5 , 2,7,4,4 , 2,8,7,7 ,
                   2,9,5,5 , 1,11,41 , 2,10,11,11 , 2,8,11,19 , 2,9,8,8 ,
                   2,4,7,32 , 2,3,32,32 , 2,6,7,7 , 2,7,19,19 , 2,19,3,3 ,
                   2,19,41,17 , 2,4,17,17 , 2,5,19,19 , 2,2,19,19 , 2,0,19,19 ,
                   2,4,10,24 , 2,2,24,24 , 2,3,24,24 , 9,6,24 , 1,11,23 ,
                   2,9,41,11 , 2,7,10,35 , 2,17,7,7 , 2,1,17,17 , 2,0,7,7 ,
                   1,10,25 , 2,5,10,10 , 2,8,5,5 , 2,4,9,33 , 2,2,33,33 ,
                   1,11,42 , 2,1,10,11 , 2,3,10,10 , 2,0,10,10 , 2,11,4,4 ,
                   2,32,11,11 , 2,33,42,38 , 2,17,38,38 , 2,2,8,8 , 2,4,8,8 ,
                   1,9,43 , 2,17,32,9 , 2,5,17,17 , 2,5,35,12 , 2,2,5,5 ,
                   2,10,35,35 , 2,33,12,12 , 2,9,42,36 , 2,7,9,9 , 2,5,24,24 ,
                   2,9,5,5 , 1,7,22 , 2,8,9,7 , 2,0,2,40 , 2,32,35,31 ,
                   2,3,24,27 , 2,35,36,39 , 2,3,4,29 , 2,31,33,37 , 2,11,12,14 ,
                   2,10,14,15 , 2,4,22,26 , 2,26,27,30 , 2,6,17,20 , 2,10,11,13 ,
                   2,22,24,28 , 2,17,19,16 , 2,6,19,21 , 2,32,38,34 , 9,1,5 ,
                   9,4,23 , 9,3,25 , 9,2,41 , 1,6,18 , 2,0,5,6 ,
                   0 };
uint8_t lfZ4096[]  = {  9,5,8 , 9,1,9 , 2,42,43,43 , 2,11,16,16 , 2,39,2,2 ,
                   2,41,40,40 , 2,23,6,6 , 2,15,37,37 , 2,25,3,3 , 2,2,30,30 ,
                   2,26,2,2 , 2,22,20,20 , 2,40,6,6 , 2,40,8,8 , 2,35,0,0 ,
                   2,43,3,3 , 2,43,4,4 , 2,3,13,13 , 2,37,32,32 , 2,37,34,34 ,
                   2,17,18,18 , 2,17,21,21 , 2,13,10,10 , 2,13,12,12 , 2,14,0,0 ,
                   2,34,31,31 , 2,34,36,36 , 2,19,16,16 , 2,19,18,18 , 2,16,20,20 ,
                   2,16,21,21 , 9,5,35 , 2,9,21,21 , 2,10,33,33 , 2,30,6,6 ,
                   2,35,1,1 , 2,35,7,7 , 2,24,28,28 , 2,29,24,24 , 2,29,27,27 ,
                   2,24,30,30 , 2,18,27,27 , 2,18,32,32 , 2,33,38,38 , 2,31,32,32 ,
                   2,31,33,33 , 9,4,14 , 2,14,8,8 , 2,14,30,30 , 9,7,22 ,
                   2,12,4,4 , 2,22,2,2 , 2,8,38,38 , 2,23,24,24 , 2,27,8,8 ,
                   2,24,39,39 , 2,27,5,5 , 2,0,20,20 , 2,6,0,0 , 9,6,22 ,
                   2,28,21,21 , 2,22,15,15 , 2,36,0,0 , 2,36,2,2 , 2,36,28,28 ,
                   9,1,38 , 2,38,30,30 , 2,38,33,33 , 2,12,38,38 , 2,10,6,6 ,
                   2,8,2,2 , 2,8,4,4 , 2,20,30,30 , 2,14,10,10 , 9,2,20 ,
                   2,20,2,2 , 2,38,10,10 , 2,38,15,15 , 2,15,8,8 , 2,9,33,33 ,
                   2,7,8,8 , 2,33,5,5 , 2,33,7,7 , 2,28,10,10 , 2,28,3,3 ,
                   2,28,4,4 , 9,10,27 , 2,32,9,9 , 2,32,4,4 , 2,32,20,20 ,
                   2,6,39,39 , 2,9,6,6 , 2,27,9,9 , 2,30,1,1 , 2,30,3,3 ,
                   2,30,6,6 , 2,30,7,7 , 2,21,0,0 , 2,21,1,1 , 2,25,10,10 ,
                   2,21,6,6 , 2,21,5,5 , 2,20,21,21 , 2,21,7,7 , 2,8,21,21 ,
                   2,39,8,8 , 2,9,10,10 , 2,21,9,9 , 2,3,10,10 , 2,18,11,11 ,
                   2,20,11,11 , 2,26,11,11 , 2,0,6,6 , 2,0,3,3 , 2,7,11,11 ,
                   2,3,7,7 , 2,4,7,7 , 2,1,11,11 , 2,1,3,3 , 2,15,11,11 ,
                   0 };
uint8_t lfA6561[]  = {  2,6,2,2 , 3,2,5,2 , 3,6,3,16 , 3,16,4,16 , 3,3,7,3 ,
                   3,4,5,4 , 2,7,5,5 , 9,3,16 , 1,6,19 , 2,7,6,6 ,
                   3,2,6,21 , 2,1,21,21 , 3,5,16,5 , 2,5,2,2 , 2,1,5,5 ,
                   3,4,1,13 , 2,0,13,13 , 2,2,13,13 , 9,2,13 , 2,16,4,4 ,
                   1,5,12 , 2,4,19,5 , 2,13,4,4 , 2,3,4,9 , 2,1,9,9 ,
                   2,13,21,15 , 2,0,21,21 , 2,3,13,8 , 2,0,8,8 , 2,2,13,13 ,
                   2,12,3,3 , 2,21,5,5 , 2,8,16,16 , 3,21,4,20 , 3,20,3,17 ,
                   9,5,6 , 2,8,9,10 , 3,16,15,14 , 3,13,12,11 , 2,3,21,22 ,
                   9,1,6 , 9,4,19 , 1,3,18 , 1,7,3 , 2,0,6,7 ,
                   0 };
uint8_t lfZ6561[]  = {  3,4,5,4 , 1,14,5 , 3,6,7,6 , 1,21,7 , 9,0,1 ,
                   3,18,20,18 , 3,1,4,1 , 3,9,22,9 , 2,7,15,15 , 2,9,8,8 ,
                   2,9,10,10 , 2,12,11,11 , 2,12,13,13 , 2,1,3,3 , 2,16,15,15 ,
                   3,5,16,5 , 2,15,1,1 , 2,15,19,19 , 3,10,0,10 , 2,18,0,0 ,
                   3,17,8,17 , 3,8,6,8 , 2,8,13,13 , 2,10,8,8 , 3,0,13,0 ,
                   2,3,17,17 , 2,5,3,3 , 2,3,13,13 , 2,19,3,3 , 2,2,1,1 ,
                   2,17,1,1 , 3,17,11,17 , 2,17,0,0 , 2,2,8,8 , 2,13,2,2 ,
                   2,13,3,3 , 3,6,2,6 , 2,11,2,2 , 2,8,2,2 , 3,22,8,22 ,
                   2,5,10,10 , 2,17,5,5 , 6,2,3 , 2,22,4,4 , 3,5,22,5 ,
                   2,1,7,7 , 2,7,5,5 , 3,6,3,6 , 3,7,11,7 , 3,7,6,7 ,
                   2,10,6,6 , 6,2,0 , 6,2,4 , 3,7,18,7 , 6,2,1 ,
                   2,1,2,2 , 2,3,4,4 , 2,0,5,5 , 0 };
uint8_t lfA8192[]  = {  2,8,5,5 , 2,12,7,7 , 2,4,2,2 , 2,8,4,4 , 2,9,5,5 ,
                   2,10,7,7 , 2,9,4,4 , 2,4,2,2 , 2,4,3,3 , 2,10,8,8 ,
                   2,9,10,33 , 2,33,6,6 , 2,7,33,33 , 2,11,9,9 , 2,4,33,33 ,
                   2,5,4,4 , 1,11,32 , 2,9,12,11 , 2,6,8,36 , 2,36,11,11 ,
                   2,3,36,36 , 2,4,36,36 , 2,2,5,47 , 2,11,4,4 , 2,9,5,5 ,
                   1,10,43 , 2,7,36,10 , 2,1,36,36 , 2,5,36,36 , 2,47,7,7 ,
                   2,0,7,7 , 2,6,47,47 , 2,12,32,17 , 2,1,47,47 , 2,9,32,29 ,
                   2,8,43,41 , 2,12,43,42 , 2,2,29,29 , 2,29,41,41 , 2,3,29,29 ,
                   2,33,43,22 , 2,2,33,33 , 2,6,17,45 , 2,10,45,45 , 2,4,2,2 ,
                   2,0,22,22 , 2,0,10,10 , 2,5,11,25 , 2,45,25,25 , 2,1,4,4 ,
                   2,1,45,45 , 2,29,8,8 , 2,45,8,8 , 2,6,9,18 , 2,17,18,24 ,
                   2,41,5,5 , 2,29,18,18 , 2,47,29,29 , 2,36,9,9 , 2,22,9,9 ,
                   2,29,11,11 , 2,5,24,24 , 2,9,5,5 , 2,0,1,19 , 9,6,19 ,
                   2,0,41,40 , 2,7,19,19 , 1,7,37 , 2,8,9,7 , 2,33,37,31 ,
                   2,3,31,35 , 2,24,25,27 , 2,35,36,39 , 2,2,11,14 , 2,37,39,38 ,
                   2,25,29,23 , 2,10,11,13 , 2,22,23,26 , 2,22,24,28 , 2,5,47,46 ,
                   2,5,45,44 , 2,26,27,30 , 2,4,18,20 , 2,4,19,16 , 2,3,38,34 ,
                   2,2,13,15 , 2,16,20,21 , 9,1,5 , 9,4,17 , 9,3,32 ,
                   9,2,12 , 0 };
uint8_t lfZ8192[]  = {  9,0,1 , 9,5,7 , 9,8,10 , 2,40,41,41 , 2,15,5,5 ,
                   2,4,3,3 , 2,47,46,46 , 2,43,4,4 , 2,42,4,4 , 2,38,11,11 ,
                   2,14,7,7 , 2,5,39,39 , 2,28,9,9 , 2,18,16,16 , 2,18,19,19 ,
                   2,29,25,25 , 2,29,26,26 , 2,19,17,17 , 2,19,20,20 , 2,36,31,31 ,
                   2,36,34,34 , 2,34,32,32 , 2,34,37,37 , 2,26,39,39 , 2,3,30,30 ,
                   2,30,24,24 , 2,30,25,25 , 2,25,22,22 , 2,25,27,27 , 2,45,44,44 ,
                   2,45,46,46 , 2,12,8,8 , 2,12,13,13 , 1,14,12 , 2,13,1,1 ,
                   2,21,16,16 , 2,21,20,20 , 2,2,27,27 , 9,6,28 , 2,28,7,7 ,
                   2,28,41,41 , 2,27,17,17 , 2,17,8,8 , 2,24,27,27 , 2,22,31,31 ,
                   2,35,37,37 , 2,33,31,31 , 2,33,35,35 , 2,10,5,5 , 2,39,9,9 ,
                   2,39,10,10 , 2,9,0,0 , 2,9,35,35 , 2,11,32,32 , 2,27,3,3 ,
                   2,35,11,11 , 2,35,38,38 , 2,31,5,5 , 2,16,12,12 , 2,16,31,31 ,
                   2,44,37,37 , 2,8,37,37 , 2,20,8,8 , 2,23,3,3 , 2,23,20,20 ,
                   2,7,2,2 , 2,8,7,7 , 2,10,31,31 , 2,44,10,10 , 2,26,6,6 ,
                   2,17,38,38 , 2,17,44,44 , 2,32,20,20 , 2,31,32,32 , 9,7,31 ,
                   2,41,7,7 , 2,46,10,10 , 2,46,41,41 , 2,24,8,8 , 2,4,12,12 ,
                   2,32,1,1 , 2,32,4,4 , 2,4,22,22 , 2,11,10,10 , 2,11,4,4 ,
                   2,6,27,27 , 2,38,6,6 , 2,13,44,44 , 2,3,31,31 , 2,41,3,3 ,
                   2,22,6,6 , 2,41,22,22 , 2,41,44,44 , 2,22,8,8 , 2,7,9,9 ,
                   2,27,7,7 , 2,12,24,24 , 2,22,12,12 , 2,26,12,12 , 2,31,4,4 ,
                   2,31,7,7 , 2,13,11,11 , 2,44,9,9 , 2,24,44,44 , 9,10,44 ,
                   2,37,31,31 , 2,31,10,10 , 2,5,6,6 , 2,15,31,31 , 2,44,3,3 ,
                   2,44,5,5 , 2,44,4,4 , 9,0,37 , 2,1,2,2 , 2,37,0,0 ,
                   2,37,1,1 , 2,37,5,5 , 2,37,7,7 , 2,37,6,6 , 2,8,9,9 ,
                   2,31,38,38 , 2,37,12,12 , 2,12,11,11 , 2,44,12,12 , 2,2,6,6 ,
                   2,2,8,8 , 2,20,2,2 , 2,3,10,10 , 2,3,5,5 , 2,20,3,3 ,
                   2,20,7,7 , 2,1,11,11 , 2,1,2,2 , 2,6,12,12 , 2,4,12,12 ,
                   2,8,12,12 , 2,38,12,12 , 2,0,4,4 , 2,0,5,5 , 0 };


uint8_t lfA14641[]  = {  1,2,4 , 2,3,2,2 , 2,2,4,4 , 2,1,2,2 , 2,1,2,5 ,
                   7,7,4,1 , 2,1,4,4 , 2,0,2,2 , 2,2,1,1 , 2,1,4,4 ,
                   9,1,3 , 2,1,2,6 , 7,2,5,6 , 2,3,5,5 , 0 };
uint8_t lfZ14641[]  = {  7,7,2,6 , 2,6,2,2 , 7,5,4,2 , 7,9,3,4 , 2,4,6,6 ,
                   7,6,0,5 , 3,0,6,0 , 2,1,2,2 , 3,1,6,1 , 6,4,2 ,
                   3,3,2,3 , 7,8,5,2 , 6,5,1 , 6,4,3 , 2,2,1,1 ,
                   6,9,0 , 3,2,0,2 , 2,4,2,2 , 0 };
uint8_t lfA15625[]  = {  3,1,4,1 , 2,2,1,1 , 6,2,2 , 6,4,4 , 3,4,5,9 ,
                   2,9,4,4 , 2,2,9,9 , 2,1,9,9 , 3,4,3,7 , 3,1,3,1 ,
                   3,3,7,3 , 2,4,7,7 , 3,3,2,8 , 2,5,2,2 , 2,1,4,4 ,
                   2,0,3,3 , 2,3,1,1 , 7,3,9,3 , 3,4,8,11 , 2,1,8,8 ,
                   2,8,7,7 , 2,2,11,12 , 2,7,11,11 , 2,8,9,10 , 2,10,2,2 ,
                   2,11,12,13 , 1,4,6 , 1,5,4 , 3,7,6,5 , 0 };
uint8_t lfZ15625[]  = {  9,1,7 , 3,10,8,10 , 7,3,9,8 , 2,8,0,0 , 3,1,12,1 ,
                   2,4,10,10 , 2,3,4,4 , 3,7,11,7 , 2,11,10,10 , 3,6,13,6 ,
                   2,2,13,13 , 2,8,12,12 , 3,1,5,1 , 7,2,5,6 , 1,11,5 ,
                   3,10,0,10 , 3,10,7,10 , 7,2,13,0 , 3,0,4,0 , 3,4,6,4 ,
                   2,1,7,7 , 3,1,4,1 , 3,4,6,4 , 3,3,2,3 , 7,3,7,2 ,
                   3,7,4,7 , 3,5,13,5 , 2,12,3,3 , 2,12,4,4 , 2,1,7,7 ,
                   2,8,5,5 , 7,2,0,1 , 3,0,10,0 , 3,3,2,3 , 2,10,2,2 ,
                   6,4,4 , 3,7,0,7 , 7,2,7,5 , 0 };
uint8_t lfA16384[]  = {  2,6,3,3 , 2,9,3,3 , 2,13,3,3 , 2,6,5,5 , 2,13,4,4 ,
                   2,11,5,5 , 2,10,6,6 , 2,8,4,4 , 2,12,10,10 , 2,12,8,8 ,
                   2,9,8,8 , 2,9,11,18 , 2,18,10,10 , 2,8,18,18 , 9,9,10 ,
                   2,6,10,10 , 2,5,10,10 , 2,7,5,5 , 2,13,7,7 , 2,7,8,50 ,
                   2,4,50,50 , 2,2,50,50 , 9,2,50 , 1,12,41 , 2,13,12,12 ,
                   1,11,52 , 2,6,11,11 , 2,12,6,6 , 2,3,11,11 , 2,4,3,3 ,
                   9,9,11 , 1,13,33 , 2,6,8,8 , 2,52,13,13 , 2,7,12,44 ,
                   2,5,44,44 , 2,2,44,44 , 2,1,44,44 , 2,11,41,47 , 2,10,11,38 ,
                   2,50,38,38 , 2,8,11,11 , 2,11,18,32 , 2,3,32,32 , 2,10,3,3 ,
                   2,12,18,20 , 2,38,18,18 , 2,1,38,38 , 2,6,33,28 , 2,2,28,28 ,
                   2,0,10,10 , 2,10,28,28 , 2,9,7,7 , 2,38,9,9 , 2,7,6,6 ,
                   2,18,7,7 , 2,8,13,16 , 2,44,8,8 , 2,10,44,44 , 2,4,20,31 ,
                   2,10,31,31 , 2,6,10,10 , 2,38,47,47 , 2,5,38,38 , 2,1,20,29 ,
                   2,3,29,29 , 2,9,20,20 , 2,28,9,9 , 2,5,33,42 , 2,2,42,42 ,
                   9,4,42 , 2,7,42,42 , 2,29,11,11 , 9,5,18 , 2,42,18,18 ,
                   2,44,16,16 , 2,9,5,5 , 1,13,51 , 2,0,1,25 , 1,7,27 ,
                   2,8,9,7 , 2,0,50,49 , 2,10,11,13 , 9,6,25 , 2,2,31,37 ,
                   2,31,32,35 , 2,37,38,39 , 2,35,39,36 , 2,25,27,24 , 2,3,47,43 ,
                   2,4,11,14 , 2,42,43,45 , 2,25,29,23 , 2,44,45,48 , 2,24,28,22 ,
                   2,18,20,17 , 2,22,23,26 , 2,4,13,15 , 2,26,27,30 , 2,3,44,40 ,
                   9,1,5 , 2,40,42,46 , 2,16,17,19 , 2,16,20,21 , 2,2,36,34 ,
                   9,4,12 , 9,3,41 , 9,2,33 , 0 };
uint8_t lfZ16384[]  = {  9,0,3 , 9,2,9 , 2,50,49,49 , 9,5,9 , 9,4,47 ,
                   9,6,30 , 2,52,51,51 , 2,14,10,10 , 2,14,15,15 , 2,25,6,6 ,
                   2,25,24,24 , 2,33,34,34 , 2,33,39,39 , 2,44,4,4 , 2,44,43,43 ,
                   2,43,40,40 , 2,43,45,45 , 2,29,37,37 , 2,20,16,16 , 2,20,21,21 ,
                   2,26,31,31 , 2,30,9,9 , 2,30,49,49 , 2,5,13,13 , 2,15,11,11 ,
                   2,15,12,12 , 2,12,38,38 , 2,36,31,31 , 2,36,34,34 , 9,1,19 ,
                   2,19,13,13 , 2,21,17,17 , 2,21,18,18 , 2,40,28,28 , 2,23,38,38 ,
                   2,28,39,39 , 2,6,1,1 , 2,37,32,32 , 2,37,34,34 , 2,16,1,1 ,
                   2,16,18,18 , 2,51,0,0 , 2,51,47,47 , 2,27,49,49 , 2,34,35,35 ,
                   2,34,38,38 , 2,27,6,6 , 9,7,23 , 2,10,31,31 , 2,23,2,2 ,
                   2,23,8,8 , 2,24,0,0 , 2,24,8,8 , 9,8,12 , 2,22,39,39 ,
                   2,32,22,22 , 9,9,32 , 2,32,46,46 , 2,41,1,1 , 2,48,35,35 ,
                   2,48,5,5 , 2,24,48,48 , 2,39,47,47 , 2,13,17,17 , 2,45,13,13 ,
                   2,46,31,31 , 2,46,12,12 , 2,46,45,45 , 2,17,0,0 , 2,17,39,39 ,
                   2,17,28,28 , 2,2,4,4 , 2,18,2,2 , 2,38,13,13 , 2,38,4,4 ,
                   2,11,2,2 , 2,11,19,19 , 2,26,11,11 , 2,4,40,40 , 2,32,4,4 ,
                   2,32,10,10 , 2,42,31,31 , 2,49,42,42 , 2,49,19,19 , 2,28,49,49 ,
                   2,45,48,48 , 2,45,49,49 , 2,42,1,1 , 2,42,2,2 , 2,38,8,8 ,
                   2,3,48,48 , 2,12,3,3 , 2,10,12,12 , 2,41,5,5 , 2,40,8,8 ,
                   2,40,41,41 , 2,12,7,7 , 2,42,12,12 , 9,11,39 , 2,39,10,10 ,
                   2,35,2,2 , 2,29,12,12 , 2,29,18,18 , 2,35,22,22 , 2,35,19,19 ,
                   2,4,10,10 , 2,47,31,31 , 2,47,2,2 , 2,47,4,4 , 2,0,6,6 ,
                   2,0,11,11 , 2,31,0,0 , 2,31,4,4 , 2,19,4,4 , 2,19,9,9 ,
                   2,19,11,11 , 2,3,4,4 , 2,22,3,3 , 2,22,5,5 , 2,22,7,7 ,
                   2,47,27,27 , 2,6,48,48 , 2,41,6,6 , 2,49,7,7 , 2,18,9,9 ,
                   2,18,49,49 , 2,9,41,41 , 2,49,8,8 , 2,2,48,48 , 2,48,9,9 ,
                   2,48,10,10 , 2,49,41,41 , 2,38,27,27 , 2,35,27,27 , 2,1,2,2 ,
                   2,12,9,9 , 2,13,1,1 , 2,13,3,3 , 2,13,9,9 , 2,5,13,13 ,
                   2,11,5,5 , 9,11,12 , 2,12,9,9 , 2,41,12,12 , 2,13,6,6 ,
                   9,7,13 , 2,13,7,7 , 2,13,8,8 , 2,13,12,12 , 1,31,13 ,
                   2,2,12,12 , 2,26,13,13 , 2,22,13,13 , 2,12,13,13 , 2,27,12,12 ,
                   2,11,12,12 , 2,17,13,13 , 2,10,11,11 , 2,28,10,10 , 2,6,13,13 ,
                   2,5,13,13 , 2,8,12,12 , 2,9,11,11 , 2,1,11,11 , 2,8,9,9 ,
                   2,7,8,8 , 2,0,11,11 , 2,4,13,13 , 2,3,8,8 , 2,1,7,7 ,
                   0 };

uint8_t lfA16807[]  = {  2,3,4,5 , 3,4,1,7 , 6,3,7 , 2,2,7,7 , 2,0,2,2 ,
                   1,1,8 , 7,2,3,8 , 2,2,5,6 , 7,3,7,2 , 2,6,1,1 ,
                   3,6,8,6 , 2,6,7,7 , 3,2,3,9 , 7,4,8,2 , 2,7,8,8 ,
                   0 };
uint8_t lfZ16807[]  = {  2,9,6,6 , 6,5,9 , 2,8,9,9 , 3,3,5,3 , 3,1,7,1 ,
                   3,6,1,6 , 2,9,7,7 , 1,4,5 , 1,9,4 , 7,4,2,7 ,
                   3,2,5,2 , 3,3,2,3 , 3,8,6,8 , 7,3,7,6 , 2,3,7,7 ,
                   3,3,8,3 , 2,0,2,2 , 7,3,6,0 , 3,1,6,1 , 2,2,4,4 ,
                   7,4,0,1 , 7,5,1,4 , 2,7,1,1 , 7,4,7,2 , 7,3,5,3 ,
                   0 };
uint8_t lfA19683[]  = {  2,5,1,1 , 3,2,5,2 , 2,6,5,5 , 2,7,6,6 , 6,2,3 ,
                   1,7,25 , 3,7,3,7 , 2,5,7,7 , 2,2,7,7 , 3,2,8,2 ,
                   3,25,8,23 , 2,4,2,2 , 2,8,25,26 , 3,4,6,4 , 3,6,5,21 ,
                   3,5,3,5 , 3,3,25,3 , 2,5,23,23 , 2,1,5,5 , 2,7,5,5 ,
                   2,0,23,23 , 3,3,4,14 , 3,4,6,4 , 3,25,3,12 , 2,1,3,3 ,
                   2,3,14,14 , 3,1,26,20 , 2,5,20,20 , 2,2,6,6 , 2,23,2,2 ,
                   2,2,1,1 , 2,2,4,4 , 2,1,7,7 , 3,2,3,2 , 3,21,3,11 ,
                   3,11,5,11 , 3,12,21,13 , 2,6,21,21 , 2,23,13,13 , 2,4,12,12 ,
                   2,20,23,24 , 2,13,14,16 , 3,23,21,22 , 2,6,16,17 , 3,12,11,10 ,
                   2,3,7,9 , 3,22,20,19 , 2,14,17,18 , 9,3,8 , 1,6,15 ,
                   2,4,5,6 , 0 };
uint8_t lfZ19683[]={3,19,23,19 , 3,23,24,23 , 3,16,14,16 , 3,25,26,25 , 3,22,20,22 ,
                   3,18,17,18 , 3,17,13,17 , 2,3,10,10 , 2,9,8,8 , 3,7,9,7 ,
                   2,10,11,11 , 3,12,10,12 , 3,19,18,19 , 3,7,19,7 , 9,4,19 ,
                   2,19,5,5 , 3,6,19,6 , 2,7,22,22 , 2,25,7,7 , 3,11,21,11 ,
                   3,5,11,5 , 2,5,16,16 , 2,8,1,1 , 3,6,22,6 , 3,8,22,8 ,
                   3,15,2,15 , 3,23,6,23 , 3,6,12,6 , 3,12,21,12 , 3,6,0,6 ,
                   2,16,0,0 , 2,16,25,25 , 3,12,7,12 , 2,15,7,7 , 3,11,15,11 ,
                   3,1,6,1 , 3,6,11,6 , 2,1,3,3 , 2,7,1,1 , 3,3,17,3 ,
                   3,17,12,17 , 3,7,21,7 , 2,17,2,2 , 2,17,25,25 , 2,5,3,3 ,
                   3,5,8,5 , 3,5,6,5 , 3,18,4,18 , 3,6,18,6 , 2,6,25,25 ,
                   3,7,18,7 , 2,22,11,11 , 3,5,2,5 , 2,0,2,2 , 3,0,23,0 ,
                   2,3,11,11 , 3,3,23,3 , 2,12,8,8 , 2,23,8,8 , 3,6,23,6 ,
                   3,3,5,3 , 3,4,5,4 , 2,25,5,5 , 6,2,3 , 2,7,8,8 ,
                   2,11,7,7 , 6,2,7 , 6,2,1 , 6,2,6 , 2,25,8,8 ,
                   2,4,8,8 , 2,3,4,4 , 2,0,6,6 , 3,8,2,8 , 2,1,7,7 ,
                   0 };

uint8_t lfA28561[]  = {  1,3,6 , 2,2,3,3 , 7,10,1,2 , 6,8,2 , 1,2,4 ,
                   2,1,3,2 , 2,0,2,2 , 3,0,6,5 , 7,2,4,5 , 6,9,3 ,
                   2,5,3,3 , 2,3,1,1 , 3,3,4,3 , 2,2,4,4 , 9,1,6 ,
                   0 };
uint8_t lfZ28561[]  = {  7,7,0,6 , 2,1,0,0 , 2,3,1,1 , 7,9,5,1 , 3,5,4,5 ,
                   7,7,2,5 , 2,1,2,2 , 6,6,1 , 2,6,5,5 , 3,1,0,1 ,
                   7,4,6,1 , 6,5,0 , 2,5,2,2 , 2,4,3,3 , 6,11,2 ,
                   7,11,5,0 , 3,3,5,3 , 6,3,3 , 7,11,1,3 , 0 };
uint8_t lfA32768[]  = {  2,9,4,4 , 2,7,5,5 , 2,8,7,7 , 2,12,4,4 , 2,6,5,5 ,
                   2,12,3,3 , 2,14,8,8 , 2,13,6,6 , 2,11,5,5 , 2,11,13,50 ,
                   2,50,3,3 , 2,9,50,50 , 2,10,9,9 , 2,14,10,10 , 2,12,50,42 ,
                   2,7,50,50 , 2,5,50,50 , 2,6,42,42 , 2,4,50,50 , 9,6,42 ,
                   2,10,50,50 , 9,8,50 , 1,14,33 , 2,11,50,14 , 2,7,50,50 ,
                   2,12,7,7 , 2,9,10,38 , 2,13,9,9 , 2,12,33,52 , 2,12,38,30 ,
                   9,12,52 , 2,2,50,50 , 9,2,50 , 2,6,38,38 , 2,1,38,38 ,
                   2,2,38,38 , 2,13,33,23 , 2,4,2,2 , 2,5,6,54 , 2,14,6,6 ,
                   2,54,30,30 , 2,1,54,54 , 2,3,54,54 , 2,10,23,51 , 2,42,51,51 ,
                   2,11,52,37 , 2,50,51,51 , 2,37,42,56 , 2,9,42,42 , 9,9,42 ,
                   2,3,4,18 , 2,30,4,4 , 2,18,14,14 , 2,51,18,18 , 2,0,51,51 ,
                   2,10,11,17 , 2,5,10,10 , 2,3,10,10 , 2,0,10,10 , 2,5,37,37 ,
                   2,51,37,37 , 2,8,51,51 , 9,12,51 , 2,3,7,7 , 2,23,56,27 ,
                   2,8,3,3 , 2,3,27,27 , 2,1,11,11 , 2,27,11,11 , 2,2,27,27 ,
                   2,1,17,17 , 2,17,4,4 , 2,8,17,17 , 2,8,42,42 , 2,38,8,8 ,
                   2,7,6,6 , 9,5,42 , 1,13,41 , 2,9,23,13 , 2,38,30,30 ,
                   2,30,9,9 , 2,10,30,30 , 2,2,14,36 , 2,38,36,36 , 1,12,48 ,
                   2,23,42,12 , 2,2,12,12 , 2,18,42,42 , 2,37,13,13 , 2,9,56,56 ,
                   2,13,7,7 , 2,30,5,5 , 1,9,47 , 2,7,8,9 , 1,14,32 ,
                   2,0,1,25 , 2,0,50,49 , 1,13,19 , 2,10,11,13 , 2,11,12,14 ,
                   2,37,38,39 , 2,2,37,31 , 2,31,32,35 , 2,6,27,24 , 2,3,47,43 ,
                   2,42,43,45 , 2,5,56,55 , 2,4,6,29 , 2,17,18,20 , 2,47,48,46 ,
                   2,5,54,53 , 2,27,30,26 , 2,29,30,28 , 2,42,46,40 , 2,3,40,44 ,
                   2,4,26,22 , 2,10,14,15 , 2,17,19,16 , 2,16,20,21 , 9,6,25 ,
                   9,1,5 , 9,4,23 , 2,2,36,34 , 9,3,41 , 9,2,33 ,
                   0 };
uint8_t lfZ32768[]  = {  9,3,28 , 9,1,8 , 9,4,7 , 9,9,13 , 2,49,50,50 ,
                   2,55,56,56 , 2,35,1,1 , 2,51,52,52 , 2,12,54,54 , 2,38,2,2 ,
                   2,28,32,32 , 2,37,4,4 , 2,19,56,56 , 2,36,50,50 , 2,33,52,52 ,
                   2,54,53,53 , 2,54,56,56 , 2,56,17,17 , 2,45,40,40 , 2,45,43,43 ,
                   2,41,43,43 , 2,41,46,46 , 2,29,25,25 , 2,29,26,26 , 2,44,43,43 ,
                   2,44,47,47 , 2,43,42,42 , 2,43,48,48 , 2,18,17,17 , 2,18,21,21 ,
                   2,50,5,5 , 2,50,6,6 , 2,24,25,25 , 2,24,30,30 , 9,6,19 ,
                   2,19,2,2 , 2,39,0,0 , 2,22,25,25 , 2,22,27,27 , 2,25,3,3 ,
                   2,25,23,23 , 9,9,36 , 2,36,11,11 , 2,36,14,14 , 9,4,42 ,
                   2,11,17,17 , 2,42,1,1 , 2,42,13,13 , 2,2,0,0 , 2,27,2,2 ,
                   2,14,10,10 , 2,14,15,15 , 1,32,14 , 2,34,8,8 , 2,40,1,1 ,
                   2,7,8,8 , 2,5,7,7 , 2,21,16,16 , 2,21,20,20 , 2,53,5,5 ,
                   2,10,53,53 , 2,48,17,17 , 2,7,48,48 , 2,30,4,4 , 2,30,53,53 ,
                   2,26,13,13 , 2,26,16,16 , 2,26,27,27 , 2,37,10,10 , 2,20,6,6 ,
                   2,20,56,56 , 2,52,48,48 , 2,56,7,7 , 2,11,6,6 , 9,8,19 ,
                   2,33,11,11 , 2,19,14,14 , 2,52,19,19 , 9,13,56 , 2,2,5,5 ,
                   2,56,2,2 , 2,48,56,56 , 9,0,47 , 2,47,0,0 , 2,16,15,15 ,
                   2,16,48,48 , 2,3,15,15 , 2,47,3,3 , 2,47,52,52 , 2,8,38,38 ,
                   2,39,8,8 , 2,39,52,52 , 2,52,7,7 , 2,28,52,52 , 2,46,19,19 ,
                   9,4,40 , 2,40,46,46 , 2,40,53,53 , 2,11,38,38 , 2,35,11,11 ,
                   2,52,10,10 , 2,5,40,40 , 2,15,5,5 , 2,15,7,7 , 2,34,5,5 ,
                   2,34,27,27 , 2,2,6,6 , 2,17,0,0 , 2,17,2,2 , 2,31,4,4 ,
                   2,23,31,31 , 2,23,3,3 , 2,9,40,40 , 2,17,9,9 , 2,53,6,6 ,
                   2,12,53,53 , 2,34,12,12 , 2,38,10,10 , 2,48,23,23 , 2,48,38,38 ,
                   2,23,9,9 , 2,14,0,0 , 2,14,46,46 , 2,14,7,7 , 2,14,9,9 ,
                   2,8,11,11 , 2,38,14,14 , 2,53,8,8 , 2,27,8,8 , 2,27,9,9 ,
                   2,56,3,3 , 2,52,23,23 , 2,40,10,10 , 2,40,11,11 , 2,14,30,30 ,
                   2,53,13,13 , 2,46,56,56 , 2,46,5,5 , 2,46,9,9 , 2,31,2,2 ,
                   2,31,19,19 , 2,0,31,31 , 2,56,8,8 , 2,31,56,56 , 2,23,46,46 ,
                   9,4,56 , 2,56,4,4 , 2,56,6,6 , 2,56,10,10 , 2,56,13,13 ,
                   2,1,2,2 , 2,7,46,46 , 2,31,7,7 , 2,31,9,9 , 2,13,14,14 ,
                   2,12,13,13 , 2,46,13,13 , 2,30,12,12 , 9,1,19 , 2,33,14,14 ,
                   2,26,14,14 , 2,19,3,3 , 2,1,4,4 , 2,19,1,1 , 2,19,5,5 ,
                   2,19,9,9 , 2,19,6,6 , 2,19,10,10 , 2,1,10,10 , 2,2,8,8 ,
                   2,19,12,12 , 2,19,13,13 , 2,0,12,12 , 2,2,7,7 , 2,6,13,13 ,
                   2,5,9,9 , 2,3,8,8 , 0 };

uint8_t lfA59049[]  = {  3,2,7,2 , 2,6,5,5 , 3,4,6,4 , 3,3,6,3 , 6,2,2 ,
                   2,4,6,12 , 3,6,7,6 , 3,4,8,4 , 2,8,9,17 , 3,17,5,14 ,
                   9,5,14 , 3,5,6,5 , 1,7,25 , 2,14,7,7 , 3,14,12,14 ,
                   3,12,3,12 , 1,14,27 , 1,9,18 , 2,6,18,9 , 2,27,9,9 ,
                   2,1,9,9 , 2,9,27,27 , 2,0,27,27 , 1,8,19 , 3,8,2,8 ,
                   2,0,8,8 , 3,8,12,8 , 2,2,7,7 , 2,9,12,12 , 3,4,7,4 ,
                   3,3,17,24 , 2,7,24,24 , 2,12,7,7 , 2,3,6,16 , 2,2,6,6 ,
                   2,7,6,6 , 9,6,9 , 3,25,2,30 , 2,3,2,2 , 2,6,3,3 ,
                   2,8,6,6 , 3,19,16,13 , 2,0,13,13 , 2,30,25,25 , 2,3,25,25 ,
                   2,13,5,5 , 3,13,25,13 , 2,13,2,2 , 2,8,16,16 , 1,7,15 ,
                   2,0,1,7 , 2,0,30,29 , 2,24,27,28 , 9,1,6 , 9,5,17 ,
                   3,27,25,26 , 3,26,24,23 , 2,3,17,20 , 2,8,9,10 , 2,4,20,21 ,
                   2,3,21,22 , 3,16,15,14 , 3,13,12,11 , 9,3,18 , 9,4,19 ,
                   0 };
uint8_t lfZ59049[]  = {  3,4,5,4 , 1,28,5 , 3,29,30,29 , 3,18,20,18 , 3,26,24,26 ,
                   2,19,18,18 , 2,22,17,17 , 2,17,21,21 , 3,9,18,9 , 2,21,29,29 ,
                   3,12,5,12 , 2,10,9,9 , 3,8,10,8 , 2,29,6,6 , 2,29,7,7 ,
                   3,26,7,26 , 3,6,8,6 , 2,11,12,12 , 3,13,11,13 , 2,16,15,15 ,
                   3,14,16,14 , 3,14,1,14 , 2,2,0,0 , 2,26,1,1 , 3,13,23,13 ,
                   2,15,21,21 , 2,15,23,23 , 3,6,3,6 , 3,3,13,3 , 9,1,3 ,
                   3,5,8,5 , 3,17,19,17 , 3,5,26,5 , 3,1,3,1 , 2,17,22,22 ,
                   2,9,25,25 , 3,0,12,0 , 3,9,0,9 , 3,0,14,0 , 2,12,9,9 ,
                   2,27,6,6 , 3,12,27,12 , 3,22,27,22 , 2,13,5,5 , 2,21,13,13 ,
                   2,6,23,23 , 2,4,6,6 , 3,4,25,4 , 2,6,25,25 , 3,3,4,3 ,
                   3,4,0,4 , 2,23,0,0 , 2,9,2,2 , 3,23,9,23 , 3,18,6,18 ,
                   3,6,13,6 , 2,23,3,3 , 3,6,23,6 , 3,14,22,14 , 3,22,18,22 ,
                   2,5,6,6 , 2,4,5,5 , 2,7,4,4 , 2,26,13,13 , 3,8,7,8 ,
                   3,7,14,7 , 3,8,22,8 , 3,8,9,8 , 3,7,6,7 , 2,3,6,6 ,
                   2,12,3,3 , 2,12,4,4 , 3,1,25,1 , 3,9,13,9 , 9,2,25 ,
                   2,2,3,3 , 3,9,2,9 , 3,2,25,2 , 2,6,9,9 , 3,6,5,6 ,
                   2,25,5,5 , 6,2,8 , 3,7,25,7 , 3,8,25,8 , 2,2,7,7 ,
                   6,2,3 , 2,0,4,4 , 2,1,2,2 , 2,1,3,3 , 2,0,7,7 ,
                   3,9,22,9 , 0 };
uint8_t lfA65536[]  = {  2,7,6,6 , 2,14,3,3 , 2,9,3,3 , 2,9,7,7 , 2,15,11,11 ,
                   2,13,4,4 , 2,15,6,6 , 2,8,4,4 , 2,13,12,12 , 2,10,7,7 ,
                   2,13,10,10 , 2,14,13,13 , 2,15,14,14 , 2,12,13,18 , 2,18,6,6 ,
                   2,11,18,18 , 2,6,18,18 , 2,5,18,18 , 2,10,5,5 , 1,15,27 ,
                   2,9,14,15 , 2,10,9,9 , 2,3,15,15 , 2,5,15,15 , 2,8,5,5 ,
                   2,1,15,15 , 2,10,12,12 , 2,0,15,15 , 2,9,12,33 , 2,8,12,12 ,
                   2,7,12,12 , 2,4,12,12 , 2,2,12,12 , 2,14,4,4 , 2,11,14,23 ,
                   2,10,23,23 , 2,7,23,23 , 2,18,23,23 , 2,14,27,52 , 2,11,52,38 ,
                   2,13,11,11 , 2,6,38,38 , 2,8,6,6 , 2,2,38,38 , 2,1,38,38 ,
                   2,7,33,57 , 2,11,33,33 , 2,7,9,63 , 2,8,7,7 , 2,52,63,36 ,
                   2,5,63,63 , 2,2,63,63 , 2,3,63,63 , 9,2,63 , 2,63,57,57 ,
                   2,3,33,33 , 2,1,33,33 , 2,11,36,25 , 2,8,25,25 , 2,11,27,43 ,
                   2,10,43,41 , 2,0,57,57 , 2,6,43,43 , 2,33,43,43 , 2,12,43,43 ,
                   2,36,41,19 , 2,6,36,36 , 2,1,19,19 , 9,10,19 , 2,4,36,35 ,
                   2,35,10,10 , 2,5,35,35 , 2,4,27,42 , 2,7,4,4 , 9,8,35 ,
                   2,3,52,32 , 2,36,3,3 , 2,33,36,36 , 2,57,33,33 , 9,13,33 ,
                   2,32,63,51 , 2,42,32,32 , 2,2,42,42 , 2,18,51,51 , 2,23,41,41 ,
                   2,32,41,41 , 2,10,57,56 , 2,15,57,57 , 2,7,33,40 , 2,8,40,40 ,
                   2,10,23,23 , 2,23,19,19 , 2,56,19,19 , 2,12,33,33 , 2,18,12,12 ,
                   2,14,35,49 , 2,8,49,49 , 2,36,49,49 , 2,42,18,18 , 9,9,40 ,
                   9,11,49 , 2,5,49,49 , 2,0,49,49 , 2,8,40,40 , 2,38,8,8 ,
                   2,15,9,9 , 2,3,25,25 , 2,1,35,35 , 2,15,35,35 , 9,6,10 ,
                   2,35,10,10 , 9,5,40 , 2,13,40,40 , 2,13,5,5 , 1,15,60 ,
                   2,57,7,7 , 2,0,63,62 , 1,7,20 , 2,8,9,7 , 2,0,1,50 ,
                   9,6,50 , 1,13,30 , 2,10,11,13 , 2,2,25,24 , 1,14,53 ,
                   2,11,12,14 , 2,23,25,29 , 2,10,14,15 , 2,35,36,39 , 2,41,43,47 ,
                   2,32,35,31 , 2,42,43,45 , 2,31,33,37 , 2,3,50,58 , 2,40,41,44 ,
                   2,18,20,17 , 2,29,30,28 , 2,44,45,48 , 2,24,28,22 , 2,40,42,46 ,
                   2,18,19,21 , 2,17,19,16 , 2,2,30,26 , 2,50,60,55 , 2,49,51,54 ,
                   2,4,56,61 , 2,3,61,59 , 2,32,38,34 , 9,1,5 , 9,4,53 ,
                   9,3,52 , 9,2,27 , 0 };
uint8_t lfZ65536[]  = {  2,4,3,3 , 1,35,4 , 2,1,33,33 , 2,62,63,63 , 2,33,34,34 ,
                   2,33,39,39 , 9,11,24 , 2,6,36,36 , 2,29,25,25 , 2,29,26,26 ,
                   2,43,40,40 , 2,43,45,45 , 2,21,16,16 , 2,21,20,20 , 2,36,31,31 ,
                   2,36,34,34 , 2,59,51,51 , 2,59,57,57 , 2,52,51,51 , 2,52,54,54 ,
                   2,28,23,23 , 2,28,25,25 , 2,56,57,57 , 2,56,60,60 , 2,60,49,49 ,
                   2,60,61,61 , 2,61,54,54 , 2,61,55,55 , 2,27,22,22 , 2,27,25,25 ,
                   2,30,11,11 , 2,30,25,25 , 9,3,37 , 2,51,49,49 , 2,51,50,50 ,
                   2,39,45,45 , 2,18,16,16 , 2,18,19,19 , 2,58,49,49 , 2,58,53,53 ,
                   2,38,4,4 , 2,38,34,34 , 2,20,17,17 , 2,20,19,19 , 2,24,12,12 ,
                   2,24,15,15 , 9,9,39 , 2,39,7,7 , 2,39,8,8 , 2,8,46,46 ,
                   2,34,3,3 , 2,34,32,32 , 2,14,10,10 , 2,14,15,15 , 1,47,14 ,
                   2,32,48,48 , 9,10,23 , 2,23,12,12 , 2,23,13,13 , 2,46,14,14 ,
                   2,42,45,45 , 2,42,46,46 , 2,14,17,17 , 2,44,41,41 , 2,44,46,46 ,
                   2,40,46,46 , 2,40,48,48 , 2,63,17,17 , 2,53,12,12 , 2,37,16,16 ,
                   2,46,3,3 , 2,54,11,11 , 2,5,13,13 , 2,49,16,16 , 2,49,5,5 ,
                   2,49,54,54 , 2,0,41,41 , 2,57,0,0 , 2,41,16,16 , 2,26,41,41 ,
                   2,26,57,57 , 2,25,12,12 , 2,12,31,31 , 2,22,45,45 , 2,10,1,1 ,
                   2,22,10,10 , 2,10,12,12 , 2,15,48,48 , 2,15,25,25 , 2,16,1,1 ,
                   2,25,16,16 , 2,57,25,25 , 9,10,15 , 2,46,10,10 , 2,55,1,1 ,
                   2,7,55,55 , 2,63,4,4 , 2,55,4,4 , 2,55,54,54 , 2,15,55,55 ,
                   2,50,19,19 , 2,50,12,12 , 2,50,10,10 , 2,50,32,32 , 2,12,14,14 ,
                   2,37,12,12 , 2,32,37,37 , 2,63,37,37 , 2,13,3,3 , 2,13,2,2 ,
                   9,13,26 , 2,54,7,7 , 2,25,54,54 , 2,41,53,53 , 2,5,7,7 ,
                   2,41,5,5 , 9,12,25 , 2,54,26,26 , 2,6,26,26 , 2,25,5,5 ,
                   2,25,6,6 , 2,31,1,1 , 2,17,31,31 , 2,17,5,5 , 9,2,19 ,
                   2,57,54,54 , 2,22,9,9 , 2,22,54,54 , 2,19,2,2 , 2,19,5,5 ,
                   2,8,55,55 , 2,19,8,8 , 2,19,17,17 , 2,31,0,0 , 2,31,2,2 ,
                   2,31,16,16 , 2,48,1,1 , 2,11,48,48 , 2,11,6,6 , 2,45,0,0 ,
                   2,45,3,3 , 2,45,5,5 , 2,26,37,37 , 2,17,11,11 , 2,17,26,26 ,
                   2,26,9,9 , 2,37,8,8 , 2,37,12,12 , 2,10,12,12 , 2,55,10,10 ,
                   2,55,11,11 , 2,4,8,8 , 2,4,7,7 , 2,53,4,4 , 2,53,16,16 ,
                   2,31,12,12 , 2,54,11,11 , 2,14,7,7 , 2,5,6,6 , 2,32,46,46 ,
                   2,2,5,5 , 2,48,2,2 , 2,48,4,4 , 9,3,16 , 2,48,41,41 ,
                   2,54,46,46 , 2,16,3,3 , 2,16,6,6 , 2,16,7,7 , 2,45,9,9 ,
                   2,16,45,45 , 2,45,10,10 , 2,14,45,45 , 2,14,12,12 , 2,41,14,14 ,
                   2,11,46,46 , 2,45,11,11 , 2,45,26,26 , 9,13,26 , 2,26,13,13 ,
                   2,57,15,15 , 2,14,15,15 , 2,46,14,14 , 2,26,15,15 , 2,63,15,15 ,
                   2,2,4,4 , 2,31,15,15 , 2,5,12,12 , 2,9,13,13 , 2,9,11,11 ,
                   2,4,15,15 , 2,7,12,12 , 2,6,12,12 , 2,7,11,11 , 2,6,14,14 ,
                   2,8,12,12 , 2,1,7,7 , 2,0,4,4 , 2,1,14,14 , 2,6,13,13 ,
                   2,0,9,9 , 2,0,3,3 , 0 };
uint8_t lfA78125[]  = {  7,2,4,1 , 3,4,3,4 , 6,2,2 , 3,3,5,3 , 3,3,4,3 ,
                   2,5,2,2 , 6,2,5 , 6,2,3 , 1,5,14 , 7,2,6,5 ,
                   1,5,10 , 7,2,4,5 , 3,4,10,4 , 3,5,2,5 , 2,10,14,15 ,
                   2,1,15,15 , 2,5,15,15 , 3,14,2,14 , 2,0,5,5 , 9,1,15 ,
                   1,6,12 , 7,3,4,12 , 2,15,12,12 , 3,15,14,15 , 7,2,15,10 ,
                   2,5,10,10 , 1,6,9 , 7,3,3,9 , 2,1,9,9 , 3,3,6,13 ,
                   2,15,3,3 , 2,5,1,1 , 2,10,3,3 , 2,10,2,2 , 2,3,14,14 ,
                   2,14,13,13 , 3,13,12,11 , 3,10,9,8 , 2,8,4,4 , 2,14,15,16 ,
                   1,4,7 , 1,6,4 , 3,7,5,6 , 0 };
uint8_t lfZ78125[]  = {  7,2,10,9 , 3,10,8,10 , 9,0,6 , 3,14,16,14 , 7,3,15,16 ,
                   2,9,14,14 , 3,0,14,0 , 2,14,9,9 , 2,3,11,11 , 2,10,3,3 ,
                   3,11,13,11 , 7,2,13,12 , 6,3,0 , 2,7,0,0 , 3,5,7,5 ,
                   3,0,1,0 , 3,1,16,1 , 2,6,12,12 , 3,6,2,6 , 2,4,6,6 ,
                   2,4,3,3 , 2,6,0,0 , 3,2,0,2 , 7,3,11,0 , 2,12,11,11 ,
                   2,5,1,1 , 2,1,5,5 , 2,5,2,2 , 2,1,9,9 , 2,9,1,1 ,
                   2,11,5,5 , 3,1,11,1 , 2,4,16,16 , 2,16,4,4 , 2,5,4,4 ,
                   3,5,6,5 , 2,5,4,4 , 2,12,5,5 , 2,2,4,4 , 3,16,10,16 ,
                   7,3,3,2 , 3,6,3,6 , 2,2,9,9 , 7,2,9,3 , 2,9,5,5 ,
                   6,3,0 , 6,3,2 , 3,6,14,6 , 3,4,0,4 , 2,1,5,5 ,
                   6,2,4 , 2,0,3,3 , 3,5,0,5 , 6,2,5 , 7,3,16,6 ,
                   0 };

uint8_t lfA83521[]  = {  2,3,2,2 , 1,3,6 , 6,12,6 , 1,3,4 , 7,6,2,4 ,
                   2,1,2,2 , 7,2,2,4 , 7,7,4,1 , 2,0,2,2 , 2,0,6,5 ,
                   7,2,4,5 , 7,15,1,6 , 2,2,6,6 , 2,2,4,4 , 2,5,1,1 ,
                   9,1,3 , 0 };
uint8_t lfZ83521[]  = {  3,6,1,6 , 3,1,0,1 , 7,9,0,2 , 7,14,5,0 , 3,0,6,0 ,
                   7,9,4,3 , 3,4,2,4 , 7,2,6,2 , 9,2,3 , 9,0,2 ,
                   7,5,2,4 , 6,14,1 , 2,1,2,2 , 3,1,3,1 , 7,9,0,3 ,
                   2,3,2,2 , 7,11,4,0 , 6,14,3 , 7,6,4,1 , 6,10,2 ,
                   0 };
uint8_t lfA161051[]  = {  7,9,3,2 , 7,3,3,1 , 7,3,4,3 , 1,2,6 , 2,4,2,2 ,
                   3,3,1,5 , 7,2,2,5 , 7,6,5,6 , 2,0,2,2 , 1,4,7 ,
                   1,3,4 , 7,7,6,3 , 7,5,3,4 , 2,2,6,6 , 2,6,5,5 ,
                   2,5,4,4 , 1,0,8 , 7,9,3,8 , 2,2,3,3 , 2,1,2,2 ,
                   2,6,1,1 , 9,1,7 , 0 };
uint8_t lfZ161051[]  = {  6,8,2 , 3,2,8,2 , 3,2,4,2 , 3,5,2,5 , 9,3,8 ,
                   3,7,5,7 , 7,9,1,7 , 7,2,7,0 , 7,8,4,5 , 3,3,0,3 ,
                   3,0,6,0 , 2,8,6,6 , 3,7,8,7 , 9,0,7 , 7,4,7,0 ,
                   7,9,3,2 , 7,3,2,3 , 2,6,1,1 , 2,6,2,2 , 3,4,3,4 ,
                   3,3,2,3 , 7,6,1,2 , 7,8,5,1 , 6,9,1 , 6,5,0 ,
                   7,8,0,1 , 7,9,7,3 , 0 };

void runlf(DSPACE * dp, uint8_t * pg, Dfmt * pmx, uint64_t nor,Dfmt * tt)
{
    uint8_t * pgc;
    uint8_t opc;
    uint64_t mxs;
    Dfmt *dp1,*dp2,*dp3;
    FELT x;

    mxs=dp->nob*nor;
    pgc=pg;
    while(1)
    {
        opc=*(pgc++);
        switch(opc)
        {
          case 0:         // [ 0 ] end
            return;
          case 1:         // copy R1 R2
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            memcpy(dp2,dp1,dp->nob);
            break;
          case 2:          // [ 2 R1 R2 R3 ] Add R1,R2 giving R3
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            dp3=pmx+(*(pgc++))*mxs;
            DAdd(dp,1,dp1,dp2,dp3);
            break;
          case 3:          //  [ 3 R1 R2 R3 ] R1 - R2 -> R3
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            dp3=pmx+(*(pgc++))*mxs;
            DSub(dp,1,dp1,dp2,dp3);
            break;
          case 4:          //   [ 4 R1 R2 ] R2 += cp0*R1
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            DSMad(dp,(dp->f)->cp0,1,dp1,dp2);
            break;
          case 5:          //   [ 5 R1 R2 ] R2 +=  cp1*R1
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            DSMad(dp,(dp->f)->cp1,1,dp1,dp2);
            break;
          case 6:           //  [ 6 sc R1 ] R1 = sc * R1
            x=*(pgc++);
            x=x%(dp->f)->charc;
            dp1=pmx+(*(pgc++))*mxs;
            DSMul(dp,x,1,dp1);
            break;
          case 7:           // [ 7 sc R1 R2 ] R2 += sc * R1
            x=*(pgc++);
            x=x%(dp->f)->charc;
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            DSMad(dp,x,1,dp1,dp2);
            break;
          case 8:           //  [ 8 R1 ] R1 = 0
            dp1=pmx+(*(pgc++))*mxs;
            memset(dp1,0,dp->nob);
            break;
          case 9:           //  [ 9 R1 R2 ]  swap R1,R2
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            memcpy(tt,dp1,dp->nob);
            memcpy(dp1,dp2,dp->nob);
            memcpy(dp2,tt,dp->nob);
            break;
         case 10:           // [10 sc R1 ] R1 = R1 / sc
            x=*(pgc++);
            x=x%(dp->f)->charc;
            x=FieldInv(dp->f,x);
            dp1=pmx+(*(pgc++))*mxs;
            DSMul(dp,x,1,dp1);
            break;
          case 11:           // [11 sc R1 R2 ] R2 -= sc * R1
            x=*(pgc++);
            x=x%(dp->f)->charc;
            x=FieldNeg(dp->f,x);
            dp1=pmx+(*(pgc++))*mxs;
            dp2=pmx+(*(pgc++))*mxs;
            DSMad(dp,x,1,dp1,dp2);
            break;
          default:
            printf("Unknown op-code %d\n",(int)opc);
            exit(22);
        }
    }
}

void extract(DSPACE * dq, const Dfmt *mq, uint64_t qstride, uint64_t nor,
                 Dfmt *mp)
{
    DSPACE dp;
    uint64_t i;
    uint8_t * prog;
    const FIELD * f;
    Dfmt * tt;
    f=dq->f;
    if(f->pow==2) prog=lfAKa;
    if(f->pow==3) prog=lfACu;
    if(f->fdef==8) prog=lfA8;
    if(f->fdef==16) prog=lfA16;
    if(f->fdef==27) prog=lfA27;
    if(f->fdef==32) prog=lfA32;
    if(f->fdef==64) prog=lfA64;
    if(f->fdef==81) prog=lfA81;
    if(f->fdef==128) prog=lfA128;
    if(f->fdef==243) prog=lfA243;
    if(f->fdef==256) prog=lfA256;
    if(f->fdef==512) prog=lfA512;
    if(f->fdef==625) prog=lfA625;
    if(f->fdef==729) prog=lfA729;
    if(f->fdef==1024) prog=lfA1024;
    if(f->fdef==2048) prog=lfA2048;
    if(f->fdef==2187) prog=lfA2187;
    if(f->fdef==2401) prog=lfA2401;
    if(f->fdef==3125) prog=lfA3125;
    if(f->fdef==4096) prog=lfA4096;
    if(f->fdef==6561) prog=lfA6561;
    if(f->fdef==8192) prog=lfA8192;
    if(f->fdef==14641) prog=lfA14641;
    if(f->fdef==15625) prog=lfA15625;
    if(f->fdef==16384) prog=lfA16384;
    if(f->fdef==16807) prog=lfA16807;
    if(f->fdef==19683) prog=lfA19683;
    if(f->fdef==28561) prog=lfA28561;
    if(f->fdef==32768) prog=lfA32768;
    if(f->fdef==59049) prog=lfA59049;
    if(f->fdef==65536) prog=lfA65536;
    if(f->fdef==78125) prog=lfA78125;
    if(f->fdef==83521) prog=lfA83521;
    if(f->fdef==161051) prog=lfA161051;
    PSSet(dq->f,dq->noc,&dp);
    tt=malloc(dp.nob);
    for(i=0;i<nor;i++)
    {
        PExtract(dq,mq+i*qstride,mp+i*dp.nob,1,nor*dp.nob);
        runlf(&dp,prog,mp+i*dp.nob,nor,tt);
    }
    free(tt);
}

void assemble(DSPACE * dq, Dfmt *mq, uint64_t nor,  Dfmt *mp)
{
    DSPACE dp;
    const FIELD * f;
    uint64_t i;
    uint8_t * prog;
    Dfmt * tt;

    f=dq->f;
    if(f->pow==2) prog=lfZKa;
    if(f->pow==3) prog=lfZCu;
    if(f->fdef==8) prog=lfZ8;
    if(f->fdef==16) prog=lfZ16;
    if(f->fdef==27) prog=lfZ27;
    if(f->fdef==32) prog=lfZ32;
    if(f->fdef==64) prog=lfZ64;
    if(f->fdef==81) prog=lfZ81;
    if(f->fdef==128) prog=lfZ128;
    if(f->fdef==243) prog=lfZ243;
    if(f->fdef==256) prog=lfZ256;
    if(f->fdef==343) prog=lfZ343;
    if(f->fdef==512) prog=lfZ512;
    if(f->fdef==625) prog=lfZ625;
    if(f->fdef==729) prog=lfZ729;
    if(f->fdef==1024) prog=lfZ1024;
    if(f->fdef==2048) prog=lfZ2048;
    if(f->fdef==2187) prog=lfZ2187;
    if(f->fdef==2401) prog=lfZ2401;
    if(f->fdef==3125) prog=lfZ3125;
    if(f->fdef==4096) prog=lfZ4096;
    if(f->fdef==6561) prog=lfZ6561;
    if(f->fdef==8192) prog=lfZ8192;
    if(f->fdef==14641) prog=lfZ14641;
    if(f->fdef==15625) prog=lfZ15625;
    if(f->fdef==16384) prog=lfZ16384;
    if(f->fdef==16807) prog=lfZ16807;
    if(f->fdef==19683) prog=lfZ19683;
    if(f->fdef==28561) prog=lfZ28561;
    if(f->fdef==32768) prog=lfZ32768;
    if(f->fdef==59049) prog=lfZ59049;
    if(f->fdef==65536) prog=lfZ65536;
    if(f->fdef==78125) prog=lfZ78125;
    if(f->fdef==83521) prog=lfZ83521;
    if(f->fdef==161051) prog=lfZ161051;
    PSSet(dq->f,dq->noc,&dp);
    tt=malloc(dp.nob);
    for(i=0;i<nor;i++)
    {
        runlf(&dp,prog,mp+i*dp.nob,nor,tt);
        PAssemble(dq,mp+i*dp.nob,mq+i*dq->nob,1,nor*dp.nob);
    }
    free(tt);
}

void LLMul(DSPACE *dsa, DSPACE *dsb, uint64_t nora, 
          const Dfmt *a,uint64_t astride, const Dfmt *b, uint64_t bstride,
          Dfmt *c)
{
    uint64_t nom,sza,szb,szc,i;
    Dfmt *pma,*pmb,*pmc;
    DSPACE dpa,dpb;
    const FIELD * f;

    f=dsa->f;

// and ground field
    PSSet(f,dsa->noc,&dpa);
    PSSet(f,dsb->noc,&dpb);
    nom=f->nomatlinf;

// allocate matrices
    sza=dpa.nob*nora;
    szb=dpb.nob*dsa->noc;
    szc=dpb.nob*nora;
    pma=malloc(sza*nom);
    pmb=malloc(szb*nom);
    pmc=malloc(szc*nom);
// extract a
    extract(dsa,a,astride,nora,pma);
// extract b
    extract(dsb,b,bstride,dsa->noc,pmb);
// call PLMul to muliply pairwise
    for(i=0;i<nom;i++)
    {
        PLMul(&dpa,&dpb,nora,pma+i*sza,dpa.nob,pmb+i*szb,dpb.nob,pmc+i*szc);
    }
// assemble c
    assemble(dsb,c,nora,pmc);
// free everything
    free(pma);
    free(pmb);
    free(pmc);
}

void linftab(FIELD * f)
{
    int nom;
    f->linfscheme=0; 
    if(f->pow==2)  f->linfscheme=1;
    if(f->pow==3)  f->linfscheme=1;
    if(f->fdef==8) f->linfscheme=1;
    if(f->fdef==16) f->linfscheme=1;
    if(f->fdef==27) f->linfscheme=1;
    if(f->fdef==32) f->linfscheme=1;
    if(f->fdef==64) f->linfscheme=1;
    if(f->fdef==81) f->linfscheme=1;
    if(f->fdef==128) f->linfscheme=1;
    if(f->fdef==243) f->linfscheme=1;
    if(f->fdef==256) f->linfscheme=1;
    if(f->fdef==512) f->linfscheme=1;
    if(f->fdef==625) f->linfscheme=1;
    if(f->fdef==729) f->linfscheme=1;
    if(f->fdef==1024) f->linfscheme=1;
    if(f->fdef==2048) f->linfscheme=1;
    if(f->fdef==2187) f->linfscheme=1;
    if(f->fdef==2401) f->linfscheme=1;
    if(f->fdef==3125) f->linfscheme=1;
    if(f->fdef==4096) f->linfscheme=1;
    if(f->fdef==6561) f->linfscheme=1;
    if(f->fdef==8192) f->linfscheme=1;
    if(f->fdef==14641) f->linfscheme=1;
    if(f->fdef==15625) f->linfscheme=1;
    if(f->fdef==16384) f->linfscheme=1;
    if(f->fdef==16807) f->linfscheme=1;
    if(f->fdef==19683) f->linfscheme=1;
    if(f->fdef==28561) f->linfscheme=1;
    if(f->fdef==32768) f->linfscheme=1;
    if(f->fdef==59049) f->linfscheme=1;
    if(f->fdef==65536) f->linfscheme=1;
    if(f->fdef==78125) f->linfscheme=1;
    if(f->fdef==83521) f->linfscheme=1;
    if(f->fdef==161051) f->linfscheme=1;
// how many matrices
    nom=3;                    // quadratics
    if(f->pow==3) nom=5;      // cubics except 8 and 27
    if(f->fdef==8) nom=6;
    if(f->fdef==16) nom=9;
    if(f->fdef==27) nom=6;
    if(f->fdef==32) nom=13;
    if(f->fdef==64) nom=18;
    if(f->fdef==81) nom=9;
    if(f->fdef==128) nom=22;
    if(f->fdef==243) nom=12;
    if(f->fdef==256) nom=26;
    if(f->fdef==512) nom=30;
    if(f->fdef==625) nom=8;
    if(f->fdef==729) nom=15;
    if(f->fdef==1024) nom=35;
    if(f->fdef==2048) nom=39;
    if(f->fdef==2187) nom=19;
    if(f->fdef==2401) nom=7;
    if(f->fdef==3125) nom=11;
    if(f->fdef==4096) nom=44;
    if(f->fdef==6561) nom=23;
    if(f->fdef==8192) nom=48;
    if(f->fdef==14641) nom=7;
    if(f->fdef==15625) nom=14;
    if(f->fdef==16384) nom=53;
    if(f->fdef==16807) nom=10;
    if(f->fdef==19683) nom=27;
    if(f->fdef==28561) nom=7;
    if(f->fdef==32768) nom=57;
    if(f->fdef==59049) nom=31;
    if(f->fdef==65536) nom=64;
    if(f->fdef==78125) nom=17;
    if(f->fdef==83521) nom=7;
    if(f->fdef==161051) nom=9;
    f->nomatlinf=nom;
}

/* end of linf.c  */
